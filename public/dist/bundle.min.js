!function(t,e){t&&!t.getElementById("livereloadscript")&&((e=t.createElement("script")).async=1,e.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",e.id="livereloadscript",t.getElementsByTagName("head")[0].appendChild(e))}(self.document),function(){"use strict";function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function e(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function n(){n=function(){return t};var t={},e=Object.prototype,i=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var s=e&&e.prototype instanceof m?e:m,o=Object.create(s.prototype),a=new A(i||[]);return r(o,"_invoke",{value:E(t,n,a)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d={};function m(){}function f(){}function v(){}var g={};l(g,o,(function(){return this}));var p=Object.getPrototypeOf,y=p&&p(p(F([])));y&&y!==e&&i.call(y,o)&&(g=y);var b=v.prototype=m.prototype=Object.create(g);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(r,s,o,a){var u=h(t[r],t,s);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(c).then((function(t){l.value=t,o(l)}),(function(t){return n("throw",t,o,a)}))}a(u.arg)}var s;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return s=s?s.then(r,r):r()}})}function E(t,e,n){var i="suspendedStart";return function(r,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw s;return L()}for(n.method=r,n.arg=s;;){var o=n.delegate;if(o){var a=I(o,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=h(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}function I(t,e){var n=e.method,i=t.iterator[n];if(void 0===i)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,I(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var r=h(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var s=r.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function F(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:L}}function L(){return{value:void 0,done:!0}}return f.prototype=v,r(b,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:f,configurable:!0}),f.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},C(w.prototype),l(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,i,r,s){void 0===s&&(s=Promise);var o=new w(c(e,n,i,r),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},C(b),l(b,u,"Generator"),l(b,o,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},t.values=F,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;k(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:F(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,k(i.key),i)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e,n){return(e=k(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m(t,e,n){return m=d()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&h(r,n.prototype),r},m.apply(null,arguments)}function f(t){var e="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return m(t,arguments,c(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),h(i,t)},f(t)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){var e=d();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}(this,n)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},p.apply(this,arguments)}function y(t,e){return C(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s,o,a=[],u=!0,l=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=s.call(n)).done)&&(a.push(i.value),a.length!==e);u=!0);}catch(t){l=!0,r=t}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return a}}(t,e)||w(t,e)||I()}function b(t){return C(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||w(t)||I()}function C(t){if(Array.isArray(t))return t}function w(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=w(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function k(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var A=function(t){l(n,t);var e=g(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return s(this,n),u(v(t=e.call(this)),"images",[]),u(v(t),"tabs",[]),u(v(t),"info",void 0),u(v(t),"selectedImageNum",void 0),u(v(t),"container",void 0),u(v(t),"list",void 0),u(v(t),"tabContainer",void 0),u(v(t),"listElements",[]),t.addEventListener("wheel",t._onScroll,{passive:!1}),t.setImages(i),t.setInfo(r),t.setTabs(a),t.selectedImageNum=o,t.render(),t}return a(n,[{key:"setTabs",value:function(t){this.tabs=t}},{key:"setImages",value:function(t){this.images=t}},{key:"setInfo",value:function(t){this.info=t}},{key:"getInfo",value:function(){return this.info}},{key:"select",value:function(t){void 0!==this.selectedImageNum&&this.listElements[this.selectedImageNum].classList.remove("selected");var e=this.listElements[t];if(e){var n=this.list.clientWidth/this.listElements[t].clientWidth||1,i=e.clientWidth,r=this.listElements[0].offsetLeft;e.offsetLeft,e.offsetLeft,this.list.scrollTo((t-n/2+1)*i-r,0),this.listElements[t].classList.add("selected"),this.selectedImageNum=t}else this.list.scrollTo(0,0);this.updateTabs()}},{key:"_onScroll",value:function(t){t.preventDefault(),this.list.scrollTo(this.list.scrollLeft+t.deltaY,0)}},{key:"_onSelectImage",value:function(t,e,n){this.onSelectImage&&this.onSelectImage(t,e,n),this.select(n)}},{key:"_onSelectTab",value:function(t,e,n){console.log("tab selected",e,n),this.onSelectTab&&this.onSelectTab(t,e,n)}},{key:"createFilmStripItems",value:function(t){for(var e=this,n=document.createElement("ul"),i=function(i){var r,s,o=document.createElement("li");e.selectedImageNum===i?o.classList.add("selected"):o.classList.remove("selected");var a,u=document.createElement("img");null!==(r=t[i])&&void 0!==r&&r.size&&Array.isArray(t[i].size)?u.src=t[i].size[t[i].size.length-1]:u.src=(null===(a=t[i])||void 0===a?void 0:a.src)||t[i];u.addEventListener("click",(function(n){return e._onSelectImage(n,t[i],i)})),null!==(s=t[i])&&void 0!==s&&s.title&&u.setAttribute("title",t[i].title),o.appendChild(u),e.listElements[i]=o,n.appendChild(o)},r=0;r<t.length;r++)i(r);return n}},{key:"updateTabs",value:function(){var t,e,n=this,i=this.tabs;(this.tabContainer&&(this.tabContainer.innerHTML=""),i.length<1)&&(i=[{title:null===(t=this.info)||void 0===t?void 0:t.description,caption:null===(e=this.info)||void 0===e?void 0:e.title}]);for(var r=function(t){var e=i[t],r=document.createElement("div");r.classList.add("tab",t),e.class&&r.classList.add(e.class),r.innerHTML=e.caption||e.name||e.title||t,r.setAttribute("title",e.title||e.caption||e.name||t),r.addEventListener("click",(function(i){n._onSelectTab(i,e,t)})),n.tabContainer.appendChild(r)},s=0;s<i.length;s++)r(s)}},{key:"render",value:function(){var t=document.createElement("div");t.classList.add("filmStripContainer");var e=this.createFilmStripItems(this.images);t.appendChild(e),this.tabContainer=document.createElement("div"),this.tabContainer.classList.add("tabContainer"),this.updateTabs(),t.appendChild(this.tabContainer),this.replaceChildren(t),this.list=e,this.container=t}}]),n}(f(HTMLElement));customElements.define("film-strip",A);var F=function(t){l(n,t);var e=g(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return s(this,n),u(v(t=e.call(this,void 0,void 0,r)),"albums",void 0),u(v(t),"selectedAlbumNum",void 0),t.setAlbums(i),t.selectedAlbumNum=o,t.selectedImageNum=r,t.render(),t}return a(n,[{key:"setAlbums",value:function(t){this.albums=t}},{key:"select",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e!==this.selectedAlbumNum&&(this.selectedAlbumNum=e,this.render()),p(c(n.prototype),"select",this).call(this,t)}},{key:"getAlbum",value:function(t){var e;return void 0===t&&(t=this.selectedAlbumNum),null===(e=this.albums)||void 0===e?void 0:e[t]}},{key:"_onSelectImage",value:function(t,e,n){void 0!==e.photoset?this.select(e.titleImageNum,e.photoset):this.select(n,this.selectedAlbumNum),this.onSelectImage&&this.onSelectImage(t,this.selectedImageNum,this.selectedAlbumNum)}},{key:"_onSelectTab",value:function(t,e,n){0===n&&this.select(void 0,void 0)}},{key:"updateTabs",value:function(){var t=this.getAlbum(),e=[{name:"Albums",title:"Browse existing albums"}];if(t){var i;e.push({name:t.title,class:"currentAlbum",title:t.description||t.title});var r=null===(i=t.photos)||void 0===i?void 0:i[this.selectedImageNum];r&&e.push({name:r.title,class:"currentImage",title:r.description||r.title})}this.setTabs(e),p(c(n.prototype),"updateTabs",this).call(this)}},{key:"render",value:function(){var t=this.getAlbum();t?this.images!==t.photos&&(this.images=t.photos):this.albums&&(this.images=this.getAlbumTitleImages()),this.images?p(c(n.prototype),"render",this).call(this):console.error("AlbumStrip: No available Images to render")}},{key:"getAlbumList",value:function(){for(var t=[],e=0;e<this.albums.length;e++){for(var n=this.albums[e],i=0;i<n.photos.length;i++)n.photos[i].id===n.primary&&(n.titleImage=n.photos[i],n.titleImageNum=i);void 0===n.titleImage&&(n.titleImage=n.photos[0],n.titleImageNum=0),t.push(n)}return t}},{key:"getAlbumTitleImages",value:function(){for(var t=this.getAlbumList(),e=[],n=0;n<t.length;n++){var i=t[n].titleImage;i.photoset=n,i.photosetTitle=t[n].title,i.titleImageNum=t[n].titleImageNum,e.push(i)}return e}}]),n}(A);customElements.define("album-strip",F);var L=function(t){l(n,t);var e=g(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return s(this,n),u(v(t=e.call(this)),"listItems",void 0),t.listItems=i,t.render(),t}return a(n,[{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e=e||this.listItems;var n=function(){if(e[i]){var n=document.createElement("li");n.classList.add(i);var r=document.createElement("div");r.classList.add("label");var s=document.createElement("span");s.innerHTML=i,r.appendChild(s),n.appendChild(r),(r=document.createElement("div")).classList.add("value"),Array.isArray(e[i])||(e[i]=[e[i]]),e[i].forEach((function(t){t instanceof Element?r.appendChild(t):((s=document.createElement("span")).innerHTML=t,r.appendChild(s))})),n.appendChild(r),t.appendChild(n)}};for(var i in e)n()}}]),n}(f(HTMLElement));customElements.define("ul-tags",L);var N=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;s(this,t),u(this,"svgNS","http://www.w3.org/2000/svg"),u(this,"meta",{title:"Chameleon | Image Gallery",delimiter:" | "}),u(this,"preferences",{breakTimeDuration:10,userIdleTimeDuration:7.5,transitionDuration:2,showCursorDuration:10,filters:{safety:["0","1"]},width:void 0,height:void 0,direction:"random",fps:20,pauseMode:"smooth",imgStyle:{marginLeft:"auto",marginRight:"auto",objectFit:"contain",width:"100%",height:"100%",position:"absolute",top:0,left:0,alignment:{x:.5,y:.5}},imgLayerStyle:{opacity:0,position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,1)"},changeAlbumOnImageNumOverflow:!0}),u(this,"transitionFrame",0),u(this,"breakTimeFrame",0),u(this,"totalFrames",0),u(this,"suspended",!1),u(this,"afterTransition",void 0),u(this,"workload",0),u(this,"timer",[Date.now()]),u(this,"keysPressed",[]),u(this,"paused",!1),u(this,"userIdleTime",0),u(this,"pureMode",!1),u(this,"firstRun",!0),u(this,"albums",[]),u(this,"img",[]),u(this,"imageLayersMax",3),u(this,"imageContainer",void 0),u(this,"previousImage",void 0),u(this,"currentImageNum",0),u(this,"currentAlbumNum",0),u(this,"target",void 0),u(this,"canvasContainer",void 0),u(this,"canvas",void 0),u(this,"mask",void 0),u(this,"imageInfoBox",void 0),u(this,"filmStrip",void 0),u(this,"overlays",{imageInfoBox:{autostart:2.5,duration:5,idleEnd:!0,idleMax:5,pauseHide:!0},filmStrip:{autostart:!1,idleEnd:!0,idleMax:5,pauseHide:!0}}),n&&this.setAlbums(n),i&&this.setPreferences(i),this.target=e,this.addEventListeners(),this.dispatchEvent("Resize")}var o,l;return a(t,[{key:"get",value:function(t){return void 0===this.preferences[t]&&console.warn('preference "'+t+'" not found'),this.preferences[t]}},{key:"read",value:function(t){var e,n=t.split("."),i=this.preferences,r=S(n);try{for(r.s();!(e=r.n()).done;){var s,o=e.value;i=null===(s=i)||void 0===s?void 0:s[o]}}catch(t){r.e(t)}finally{r.f()}return i}},{key:"set",value:function(t,n){console.log(t,n),this.preferences=function t(n,i,r){var s=b(i.split(".")),o=s[0],a=s.slice(1);return e(e({},n),{},u({},o,a.length?t(n[o],a.join("."),r):r))}(this.preferences,t,n)}},{key:"setPreferences",value:function(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.preferences?this.preferences=e(e({},this.preferences),t):this.preferences=t}},{key:"getPreferences",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var t=function(t){return!isNaN(t)||t instanceof String||"string"==typeof t};return function e(n){for(var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=0,o=Object.entries(n);s<o.length;s++){var a=y(o[s],2),u=a[0],l=a[1],c=r.concat(u);Array.isArray(l)&&l.some(t)?i[c.join(".")]=l:l instanceof Object?e(l,i,r.concat(u)):i[c.join(".")]=l}return i}(this.preferences)}return this.preferences}},{key:"destroy",value:function(){this.target.removeChild(this.canvasContainer),this.removeEventListeners(),this.target=void 0,this.run=void 0}},{key:"requestFullscreen",value:function(t,e){var n=this;t.addEventListener("click",(function(){document.fullscreenElement?document.exitFullscreen():e.requestFullscreen?e.requestFullscreen(e):e.mozRequestFullScreen?e.mozRequestFullScreen(e):e.webkitRequestFullscreen?e.webkitRequestFullscreen(e):e.msRequestFullscreen&&e.msRequestFullscreen(e)})),addEventListener("fullscreenchange",(function(t){n.dispatchEvent("FullscreenChange",t)}))}},{key:"isFullscreen",value:function(){return window.fullScreen||window.innerWidth==screen.width&&window.innerHeight==screen.height}},{key:"removeEventListeners",value:function(){var t=this;document.removeEventListener("mousemove",(function(e){return t.dispatchEvent("MouseMove",e)})),document.removeEventListener("keyup",(function(e){return t.dispatchEvent("KeyUp",e)})),document.removeEventListener("keydown",(function(e){return t.dispatchEvent("KeyDown",e)})),window.removeEventListener("resize",(function(e){return t.dispatchEvent("Resize",e)})),window.removeEventListener("orientationchange",(function(e){return t.dispatchEvent("Resize",e)})),window.removeEventListener("offline",(function(e){return t.dispatchEvent("Offline",e)})),window.removeEventListener("online",(function(e){return t.dispatchEvent("Online",e)}))}},{key:"addEventListeners",value:function(){var t=this;document.addEventListener("mousemove",(function(e){return t.dispatchEvent("MouseMove",e)})),document.addEventListener("keyup",(function(e){return t.dispatchEvent("KeyUp",e)})),document.addEventListener("keydown",(function(e){return t.dispatchEvent("KeyDown",e)})),window.addEventListener("resize",(function(e){return t.dispatchEvent("Resize",e)})),window.addEventListener("orientationchange",(function(e){return t.dispatchEvent("Resize",e)})),window.addEventListener("offline",(function(e){return t.dispatchEvent("Offline",e)})),window.addEventListener("online",(function(e){return t.dispatchEvent("Online",e)}))}},{key:"navigate",value:function(){var t,e,n,r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"+1",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"+0";if(this.isPaused()&&this.dispatchEvent("PauseEnd"),"object"===i(s)||void 0===s){if(s.album&&this.setCurrentAlbumNum(this.getAlbumNumByPropertyValue(s.album)),s.image){var a=this.getImageNumByPropertyValue(s.image);a&&(this.setCurrentAlbumNum(a.album),this.setCurrentImageNum(a.image))}}else void 0!==o&&this.setCurrentAlbumNum(parseInt(o)+(("string"==typeof o||o instanceof String)&&["+","-"].indexOf(-1!==(o||0).substring(0,1))?this.getCurrentAlbumNum():0)),void 0!==s&&this.setCurrentImageNum(parseInt(s)+(("string"==typeof s||s instanceof String)&&["+","-"].indexOf(-1!==(s||0).substring(0,1))?this.getCurrentImageNum():0));var u=(null===(t=this.getAlbum())||void 0===t?void 0:t.title)||(null===(e=this.getAlbum())||void 0===e?void 0:e.name),l=(null===(n=this.getCurrentImage())||void 0===n?void 0:n.title)||(null===(r=this.getCurrentImage())||void 0===r?void 0:r.name);if(document.title=this.meta.title+this.meta.delimiter+u+this.meta.delimiter+l,!this.isFullscreen()){var c=new URL(window.location);c.searchParams.set("album",u),c.searchParams.set("image",l),history.pushState({},"",c)}this.firstRun&&(this.transitionFrame=void 0,this.firstRun=!1,this.suspended=!0),void 0===this.transitionFrame?this.startTransition():this.afterTransition=this.startTransition,this.filmStrip.select(this.currentImageNum,this.currentAlbumNum),this.dispatchEvent("Navigation",{target:this.currentImageNum})}},{key:"startTransition",value:function(){this.suspended=!0,this.transitionFrame=void 0,this.breakTimeFrame=0,this.currentDirection="random"===this.get("direction")?360*Math.random():this.get("direction"),this.updateClipPathTransition(),this.dispatchEvent("TransitionStart"),this.showImage()}},{key:"getCurrentImage",value:function(){return this.getAlbumImages()[this.currentImageNum]}},{key:"getImage",value:function(t){return this.getAlbumImages()[t]}},{key:"setCurrentAlbumNum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0!==t&&t!==this.currentAlbumNum&&(this.currentAlbumNum=t%this.albums.length<0?t%this.albums.length+this.albums.length:t%this.albums.length,this.updateFilmStrip()),void 0!==e&&e!==this.currentImageNum&&this.setCurrentImageNum(e),this.currentAlbumNum}},{key:"getAlbum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return this.albums[t||this.currentAlbumNum]}},{key:"getAlbumInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=e({},this.albums[t||this.currentAlbumNum]);return delete n.images,n}},{key:"getCurrentAlbumNum",value:function(){return this.currentAlbumNum}},{key:"getAlbumImages",value:function(){var t,e,n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return(null===(t=this.albums[r||this.currentAlbumNum])||void 0===t?void 0:t.photos)||(null===(e=this.albums)||void 0===e?void 0:e.photos)||this.photos||(null===(n=this.albums[r||this.currentAlbumNum])||void 0===n?void 0:n.images)||(null===(i=this.albums)||void 0===i?void 0:i.images)||this.albums}},{key:"getImageSrc",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"==typeof t||t instanceof String)return t;try{return(null==t?void 0:t.src)||(null==t?void 0:t.size[e])}catch(e){console.log("image #"+(t.id||t.title)+" does not provide src/sizes",e,t)}}},{key:"setCurrentImageNum",value:function(t){this.get("changeAlbumOnImageNumOverflow")&&(t>=this.getAlbumImages().length?(this.setCurrentAlbumNum(this.getCurrentAlbumNum()+1),t=0):t<0&&this.setCurrentAlbumNum(this.getCurrentAlbumNum()-1));var e=this.getAlbumImages();return this.currentImageNum=(t%e.length<0?t%e.length+e.length:t%e.length)||0}},{key:"getCurrentImageNum",value:function(){return this.currentImageNum}},{key:"setMetaData",value:function(t){this.meta=e(e({},this.meta),t)}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;!0!==(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.get("width")||this.get("height"))||this.dispatchEvent("Resize"),this.canvasContainer&&this.target.removeChild(this.canvasContainer),this.createCanvas(),this.createInfoBox(),this.createFilmStrip(!0),this.navigate(t||this.currentImageNum)}},{key:"updateOverlays",value:function(){for(var t=0,e=Object.keys(this.overlays);t<e.length;t++){var n=e[t],i=this.overlays[n];this.pureMode||this.transitionFrame||this.suspended||!(i.autostart>0&&this.breakTimeFrame===i.autostart*this.get("fps")||this.breakTimeFrame>0&&!0===i.idleEnd&&0===this.userIdleTime)?(this.pureMode||i.idleMax*this.get("fps")===this.userIdleTime&&(!i.duration||this.breakTimeFrame>i.duration*this.get("fps")))&&this[n].classList.add("hide"):this[n].classList.remove("hide")}}},{key:"update",value:function(){this.userIdleTime++,this.userIdleTime%20==0&&this.dispatchEvent("Idle",this.userIdleTime),this.isPaused()||(void 0!==this.transitionFrame?(this.transitionFrame++,this.breakTimeFrame=0):this.suspended||this.breakTimeFrame++,this.updateClipPathTransition()),this.breakTimeFrame>this.get("breakTimeDuration")*this.get("fps")&&this.userIdleTime>this.get("userIdleTimeDuration")*this.get("fps")&&!this.suspended&&this.navigate("+1")}},{key:"updateClipPathTransition",value:function(){if(this.transitionFrame>this.get("transitionDuration")*this.get("fps"))this.dispatchEvent("TransitionEnd");else if(this.transitionFrame)for(var t=1/this.get("transitionDuration")/this.get("fps"),e=0;e<this.img.length;e++){var n=this.img[e];n.style.opacity<1&&(n.style.opacity=parseFloat(n.style.opacity)+t),n.style.zIndex=this.img.length-e}}},{key:"updateFilmStrip",value:function(){this.filmStrip.setImages(this.getAlbumImages()),this.filmStrip.setInfo(this.getAlbumInfo()),this.filmStrip.render()}},{key:"run",value:function(){var t=this;this.isPaused()&&(this.paused++,this.dispatchEvent("Paused",this.paused)),this.updateOverlays(),this.update(),this.userIdleTime===this.get("showCursorDuration")*this.get("fps")&&(document.body.style.cursor="none"),this.totalFrames++,setTimeout((function(){return t.run()}),1e3/this.get("fps"))}},{key:"getImageNumByPropertyValue",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","title","name"],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;("string"==typeof n||n instanceof String)&&(n=[n]),i=null!==(e=i)&&void 0!==e?e:this.getCurrentAlbumNum();for(var r=-1;r<this.albums.length;r++){var s=-1===r?i:r;if(void 0!==r)for(var o=this.albums[s].photos||this.albums[s].images,a=0;a<o.length;a++){var u,l=o[a],c=S(n.values());try{for(c.s();!(u=c.n()).done;){if(l[u.value]==t)return{album:s,image:a}}}catch(t){c.e(t)}finally{c.f()}}}console.error("image "+t+" not found")}},{key:"getAlbumNumByPropertyValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","title","name"];("string"==typeof e||e instanceof String)&&(e=[e]);for(var n=0;n<this.albums.length;n++){var i,r=S(e.values());try{for(r.s();!(i=r.n()).done;){var s=i.value;if(this.albums[n][s]==t)return n}}catch(t){r.e(t)}finally{r.f()}}console.error("album "+t+" not found")}},{key:"loadData",value:(o=n().mark((function t(){var e,i=this,r=arguments;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:"./data/albums.json",t.abrupt("return",fetch(e).then((function(t){return t.json()})).catch((function(t){i.dispatchEvent("Error",void 0,t)})));case 2:case"end":return t.stop()}}),t)})),l=function(){var t=this,e=arguments;return new Promise((function(n,i){var s=o.apply(t,e);function a(t){r(s,n,i,a,u,"next",t)}function u(t){r(s,n,i,a,u,"throw",t)}a(void 0)}))},function(){return l.apply(this,arguments)})},{key:"applyFilters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;t=t||this.loadedAlbums||this.albums,n=n||this.get("filters");for(var i=[],r=0;r<t.length;r++){var s=e({},t[r]);s.photos=[];for(var o=0;o<t[r].photos.length;o++){var a,u=t[r].photos[o];-1!==(null===(a=this.get("filters"))||void 0===a?void 0:a.safety.indexOf(u.safety))&&s.photos.push(u)}s.photos.length>0&&i.push(s)}this.albums=i}},{key:"resetFilters",value:function(){this.albums=this.loadedAlbums}},{key:"setAlbums",value:function(t){this.loadedAlbums=t,this.applyFilters(t)}},{key:"getImageSlot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return document.getElementById("imageSlot"+(void 0!==t?t:this.albumslots.length-1))}},{key:"dispatchEvent",value:function(t){for(var e="on"+t,n="_on"+t,i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];"function"==typeof this.onEvent&&this.onEvent.apply(this,[t].concat(r)),"function"==typeof this[n]&&this[n].apply(this,r),"function"==typeof this[e]&&this[e].apply(this,r)}},{key:"isPaused",value:function(){return this.paused>0}},{key:"setPaused",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0===e&&(e=!this.paused),!0===e?this.transitionFrame&&!this.isPaused()?(this.afterTransition=function(){return t.dispatchEvent("PauseStart")},this.userIdleTime=this.infoBoxDuration*this.get("fps")-1):this.dispatchEvent("PauseStart"):this.dispatchEvent("PauseEnd"),e}},{key:"_onFullscreenChange",value:function(t){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||t.preventDefault()}},{key:"_onScroll",value:function(t){this._onIdleEnd()}},{key:"_onPureStart",value:function(){this.pureMode=!0}},{key:"_onPureEnd",value:function(){this.pureMode=!1,this._onIdleEnd()}},{key:"_onKeyUp",value:function(t){switch("Escape"===t.key?this.pureMode?this.dispatchEvent("PureEnd"):this.dispatchEvent("PureStart"):" "===t.key?this.setPaused():-1===this.keysPressed.indexOf("Shift")&&this.dispatchEvent("IdleEnd",this.userIdleTime),t.key){case"ArrowRight":this.navigate("+1");break;case"ArrowLeft":this.navigate("-1");break;case"ArrowUp":this.navigate(0,"-1");break;case"ArrowDown":this.navigate(0,"+1")}-1!==this.keysPressed.indexOf(t.key)&&this.keysPressed.splice(this.keysPressed.indexOf(t.key),1)}},{key:"_onPauseEnd",value:function(){this.paused=0}},{key:"_onPauseStart",value:function(){var t,e;(this.paused=1,this.overlays.imageInfoBox.pauseHide)&&(null===(t=this.imageInfoBox)||void 0===t||t.classList.add("hide"));this.overlays.filmStrip.pauseHide&&(null===(e=this.filmStrip)||void 0===e||e.classList.add("hide"))}},{key:"_onResize",value:function(t){var e;this.set("width",this.target.clientWidth||this.target.width||document.clientWidth||800),this.set("height",this.target.clientHeight||this.target.height||document.clientHeight||600),null===(e=this.canvas)||void 0===e||e.setAttribute("viewBox","0 0 "+this.get("width")+" "+this.get("height")),console.debug("canvas size: "+this.get("width")+"x"+this.get("height")+" fullscreen: "+this.isFullscreen());var n=this.getImageSlot(1);n&&(n.background.setAttributeNS(null,"width",this.get("width")),n.background.setAttributeNS(null,"height",this.get("height")))}},{key:"_onIdleEnd",value:function(){this.userIdleTime>0&&(this.userIdleTime=0,document.body.style.cursor="auto")}},{key:"_onMouseMove",value:function(){this.dispatchEvent("IdleEnd",this.userIdleTime),this.userIdleTime=0}},{key:"_onTransitionStart",value:function(){this.imageInfoBox.classList.add("hide")}},{key:"_onTransitionEnd",value:function(){this.showImageInfo(),this.transitionFrame=void 0,this.breakTimeFrame=0,this.suspended=!1,this.paused&&this.setPaused(!0),this.afterTransition&&(this.afterTransition(),this.afterTransition=void 0)}},{key:"_onError",value:function(t){this.showMessage("An error occurred",t),console.error(t)}},{key:"_onOnline",value:function(t){this.navigate("+0","+0")}},{key:"_onOffline",value:function(t){console.log("offline",t)}},{key:"_onImageLoad",value:function(t){this.suspended=!1,this.transitionFrame=0}},{key:"setProps",value:function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n],s=e[r];t[r]=s}}},{key:"showMessage",value:function(t){console.error(t)}},{key:"showImage",value:function(){var t=this,e=document.createElement("div"),n=document.createElement("img");n.src=this.getImageSrc(this.getCurrentImage()),n.addEventListener("error",(function(e){return t.dispatchEvent("Error",e)})),this.setProps(n.style,this.get("imgStyle")),this.img.unshift(e),this.setProps(e.style,this.get("imgLayerStyle")),this.setProps(e.style.zIndex,this.img.length+1),e.appendChild(n),this.suspended=!0,this.transitionFrame=void 0,n.onload=function(e){return t._onImageLoad()},this.imageContainer.insertBefore(e,this.imageContainer.firstChild);for(var i=this.imageLayersMax;i<this.imageContainer.children.length;i++)this.imageContainer.removeChild(this.imageContainer.children[i]),this.img.pop()}},{key:"createCanvas",value:function(){console.log("creating canvas"),this.canvasContainer=document.createElement("div"),this.target.appendChild(this.canvasContainer),this.setProps(this.canvasContainer.style,{width:"100%",height:"100%",position:"absolute"}),this.canvasContainer.setAttribute("class","canvasContainer"),this.imageContainer=document.createElement("div"),this.canvasContainer.appendChild(this.imageContainer)}},{key:"createFilmStrip",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.filmstrip&&!e||(this.filmStrip=new F(this.albums,this.currentImageNum,this.currentAlbumNum),this.filmStrip.classList.add("filmStrip","hide"),this.filmStrip.onSelectImage=function(e,n,i){t.navigate(n,i)}),this.canvasContainer.appendChild(this.filmStrip)}},{key:"createInfoBox",value:function(){if(!this.imageInfoBox){var t=document.createElement("div");t.classList.add("infoBox","hide"),t.onclick=function(e){t.classList.toggle("minified")},this.imageInfoBox=t}this.canvasContainer.appendChild(this.imageInfoBox)}},{key:"showImageInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.afterTransition||t){var n=this.imageInfoBox;t&&n.classList.remove("hide");var i=this.getCurrentImage();if("string"==typeof i||i instanceof String||0===Object.keys(i).length){var r=document.createElement("div");r.classList.add("noInfo"),r.innerHTML="No Information available",n.replaceChildren(r)}else{var s,o,a,u,l;if(null===(s=i=e({},this.getCurrentImage()))||void 0===s||delete s.src,i.camera){var c,h,d={camera:i.camera,lens:(null===(c=i.exif)||void 0===c?void 0:c.LensModel)||(null===(h=i)||void 0===h?void 0:h.Lens)};(u=new L(d)).classList.add("imageExif")}if(i.exif){var m,f,v,g,p,y,b={exposure:null===(m=i.exif)||void 0===m?void 0:m.ExposureTime,aperture:null===(f=i.exif)||void 0===f?void 0:f.FNumber,focus:null===(v=i.exif)||void 0===v?void 0:v.FocalLength,iso:null===(g=i.exif)||void 0===g?void 0:g.ISO};if(null!==(p=i.exif)&&void 0!==p&&p.Flash)"on"===(null===(y=i.exif)||void 0===y?void 0:y.Flash.substring(0,2).toLowerCase())?b.flash="on":b.noflash="off";(l=new L(b)).classList.add("imageExif")}var C={title:i.title,album:this.getAlbum().title,description:i.description,location:i.location,tags:i.tags,date:null===(o=i.dates)||void 0===o?void 0:o.taken,posted:null===(a=i.dates)||void 0===a?void 0:a.posted,gear:u,exif:l},w=new L(C);w.classList.add("imageInfo"),n.replaceChildren(w)}}}}]),t}(),x=function(t){l(n,t);var e=g(n);function n(t,i,r,o){var a;return s(this,n),u(v(a=e.call(this,t,i,r,o)),"additionalSettings",{grid:25,clipPathTransitionSpeed:2,transitionDuration:40}),u(v(a),"grid",25),u(v(a),"transitionDuration",40),u(v(a),"clipPathTransitionSpeed",2),u(v(a),"clipPath",void 0),u(v(a),"clipPathId","clipPathMask"),u(v(a),"maskedImage",void 0),u(v(a),"debugMask",!1),a.setPreferences(a.additionalSettings),a}return a(n,[{key:"_onTransitionEnd",value:function(){p(c(n.prototype),"_onTransitionEnd",this).call(this)}},{key:"_onResize",value:function(){if(p(c(n.prototype),"_onResize",this).call(this),this.canvas){console.log("updating clipMask");var t=this.clipPath;this.createClipPath(),this.canvas.replaceChild(t,this.clipPath)}}},{key:"updateClipPathTransition",value:function(){var t={frame:this.transitionFrame-1,x:4*-this.get("grid"),y:Math.max(this.get("height"),this.get("width"))-((this.transitionFrame||0)-5)*this.get("grid")*this.get("clipPathTransitionSpeed"),limitY:-this.get("height")-this.clipPathNetSize.height,direction:this.currentDirection,suspended:this.suspended,userIdleTime:this.userIdleTime};this.dispatchEvent("onTransition",t),!t.suspended&&t.y<t.limitY&&(t.y=t.limitY,this.dispatchEvent("TransitionEnd"),document.getElementById("imageGroup1").removeAttributeNS(null,"clip-path")),this.clipPath.style.transform="rotate("+t.direction+"deg) translate("+t.x+"px, "+t.y+"px)"}},{key:"createClipPath",value:function(){var t,e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=document.createElementNS(this.svgNS,this.debugMask?"g":"clipPath"),s=this.get("width"),o=this.get("height"),a=s/this.get("grid")*this.get("transitionDuration")/50,u=o/this.get("grid")*this.get("transitionDuration")/50,l=this.get("grid")*Math.PI/4;for(n=0;n<=2*Math.max(a,u);n+=1){for(e=0;e<=2*Math.max(a,u);e+=1)if(!((t=n*l/(this.get("transitionDuration")||10))<1)){if(t>l)break;var c=document.createElementNS(this.svgNS,"circle");c.setAttribute("cx",e*this.get("grid")),c.setAttribute("cy",n*this.get("grid")),c.setAttribute("r",t<l?t:l),c.setAttribute("fill","white"),c.setAttribute("stroke","none"),r.appendChild(c)}if(t>l)break}this.clipPathNetSize={width:4*s+2*this.get("grid"),height:(n-1)*this.get("grid")};var h=document.createElementNS(this.svgNS,"rect");return h.setAttributeNS(null,"x",-s),h.setAttributeNS(null,"y",(n-1)*this.get("grid")),h.setAttributeNS(null,"width",4*s+2*this.get("grid")),h.setAttributeNS(null,"height",4*o+2*this.get("grid")),h.setAttributeNS(null,"stroke","none"),h.setAttributeNS(null,"fill","red"),r.appendChild(h),r.style.transformOrigin="center center",this.debugMask||(r.id=this.clipPathId||i),r}},{key:"_onImageLoad",value:function(t,e){if(this.target instanceof HTMLCanvasElement)this.target.getContext("2d").drawImage(t.target,0,0);else if(this.target instanceof HTMLElement){if(t.target.setAttributeNS(null,"x",(this.get("width")-t.target.getBBox().width)*this.get("imgStyle").alignment.x),t.target.setAttributeNS(null,"y",(this.get("height")-t.target.getBBox().height)*this.get("imgStyle").alignment.y),t.target===this.getImageSlot(1))!this.debugMask&&this.clipPath&&document.getElementById("imageGroup1").setAttributeNS(null,"clip-path","url(#"+this.clipPathId+")"),this.getImageSlot(1).setAttributeNS(null,"visibility","visible"),this.suspended=!1,this.transitionFrame=0,this.updateClipPathTransition();else if(t.target===this.getImageSlot(0)){var n=this.getCurrentImage();this.getImageSlot(1).setAttributeNS(null,"href",this.getImageSrc(n)),!this.debugMask&&this.clipPath&&document.getElementById("imageGroup1").setAttributeNS(null,"clip-path","url(#"+this.clipPathId+")"),this.getImageSlot(1).setAttributeNS(null,"visibility","visible")}}}},{key:"showImage",value:function(){var t=this.getImageSlot(1),e=this.getImageSlot(0);if(t.getAttributeNS(null,"href"))document.getElementById("imageGroup1").removeAttributeNS(null,"clip-path"),e.setAttributeNS(null,"href",t.getAttributeNS(null,"href"));else{var n=this.getCurrentImage();t.setAttributeNS(null,"visibility","hidden"),t.setAttributeNS(null,"href",this.getImageSrc(n))}}},{key:"createCanvas",value:function(){var t=this,e=this.get("width"),n=this.get("height"),i=this.target,r=null,s=document.createElementNS(this.svgNS,"svg");s.setAttribute("viewBox","0 0 "+e+" "+n);for(var o=0;o<2;o++){var a=document.createElementNS(this.svgNS,"g");a.id="imageGroup"+o,a.setAttributeNS(null,"class","imageGroup");var u=document.createElementNS(this.svgNS,"image");u.id="imageSlot"+o,u.setAttributeNS(null,"visibility","visible"),u.addEventListener("error",(function(e){return t.dispatchEvent("Error",e)})),u.onload=function(e){return t.dispatchEvent("ImageLoad",e,t.getCurrentImage())};var l=document.createElementNS(this.svgNS,"rect");l.setAttributeNS(null,"width",this.get("width")),l.setAttributeNS(null,"height",this.get("height")),l.setAttributeNS(null,"fill","black"),u.background=l,a.appendChild(l),a.appendChild(u),s.appendChild(a)}this.createClipPath&&(r=this.createClipPath(),s.appendChild(r),this.clipPath=r);var c=document.createElement("div");i.appendChild(c),this.canvasContainer=c,this.canvasContainer.setAttribute("class","canvasContainer"),this.canvasContainer.style.width="100%",this.canvasContainer.style.height="100%",i instanceof HTMLCanvasElement?i.getContext("2d").drawImage(s,0,0):c.appendChild(s),this.canvas=s,this.dispatchEvent("CanvasCreated",{canvasContainer:this.canvasContainer,canvas:s,clipPath:r,context:i})}}]),n}(N),T=function(t){l(n,t);var e=g(n);function n(){return s(this,n),e.apply(this,arguments)}return a(n)}(N),P=function(t){l(n,t);var e=g(n);function n(t,i,r,o){var a;return s(this,n),u(v(a=e.call(this,t,i,r,o)),"img",[]),u(v(a),"additionalSettings",{zoomspeed:5,imgStyle:{display:"block",objectFit:"cover",position:"absolute",top:"50%",left:"50%",width:"100%",height:"100%",transform:"translate(-50%, -50%) scale(1)","backface-visibility":"hidden",transition:"transform 0.35s"}}),u(v(a),"animationFrame",0),u(v(a),"imageContainer",void 0),a.setPreferences(a.additionalSettings),a}return a(n,[{key:"updateClipPathTransition",value:function(){if(this.transitionFrame>this.get("transitionDuration")*this.get("fps"))this.dispatchEvent("TransitionEnd");else if(this.transitionFrame)for(var t=0;t<this.img.length;t++){var e=this.img[t];e.style.opacity<1&&(e.style.opacity=parseFloat(e.style.opacity)+1/this.get("transitionDuration")/this.get("fps")),e.style.zIndex=this.img.length-t}}},{key:"update",value:function(){p(c(n.prototype),"update",this).call(this);for(var t=0;t<this.img.length&&!(t>1);t++){this.img[t].animationFrame=void 0===this.img[t].animationFrame?0:this.img[t].animationFrame+1;var e=1+this.img[t].animationFrame*this.get("zoomspeed")/1e3/this.get("fps");this.img[t].firstChild.style.transform="translate(-50%, -50%) scale("+e+")"}}}]),n}(N),O=function(t){l(n,t);var e=g(n);function n(){var t,i,r,o,a,l,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;(s(this,n),u(v(r=e.call(this)),"menu",void 0),u(v(r),"buttons",void 0),u(v(r),"target",void 0),u(v(r),"title",void 0),u(v(r),"expanded",!1),u(v(r),"items",[]),u(v(r),"defaultMenuItemNum",void 0),u(v(r),"selectedMenuItemNum",void 0),r.menu=c,r.buttons=r.querySelectorAll((null===(t=r.attributes.button)||void 0===t?void 0:t.value)||"button.sandwich"),r.buttons.forEach((function(t){t.style="pointer-events: all;",t.addEventListener("click",(function(t){return r._onClick(t)}))})),r.attributes.target)&&(r.target=r.querySelector((null===(o=r.attributes.target)||void 0===o?void 0:o.value)||".content"));r.target||(r.target=document.createElement("div"),null!==(a=r.attributes.targetClass)&&void 0!==a&&a.value&&r.target.classList.add(r.attributes.targetClass.value.split(" ")),r.appendChild(r.target));(r.menu=r.querySelector((null===(i=r.attributes.menu)||void 0===i?void 0:i.value)||"ul.menu"),r.menu)?r.menu.querySelectorAll("li").forEach((function(t){var e=r.items.push(t);t.addEventListener("click",(function(t){return r._onClickMenuItem(e-1)})),t.style="cursor: pointer"})):(r.menu=document.createElement("ul"),null!==(l=r.attributes.menuClass)&&void 0!==l&&l.value&&r.menu.classList.add(r.attributes.menuClass.value.split(" ")),r.appendChild(r.menu));return r.createMenuItems(),r._onToggle(!1),r}return a(n,[{key:"createMenuItems",value:function(){var t=this;if(this.attributes.items.value){var e=JSON.parse(this.attributes.items.value);if(Array.isArray(e)){var n=function(){var n=document.createElement("li");if(e[i]instanceof String||"string"==typeof e[i])n.innerHTML=e[i];else{n.innerHTML=e[i].title;for(var r=0,s=Object.keys(e[i]);r<s.length;r++){var o=s[r];n.dataset[o]=e[i][o]}}n.style="cursor: pointer",t.menu.appendChild(n);var a=t.items.push(n)-1;n.addEventListener("click",(function(e){return t._onClickMenuItem(a)})),!0===e[i].default&&(t.defaultMenuItemNum=a,t.selectMenuItemNum(a))};for(var i in e)n()}}}},{key:"_onLoadPage",value:function(t,e,n){"function"==typeof this.onLoadPage&&this.onLoadPage(t,e,n)}},{key:"selectMenuItemNum",value:function(t){var e,n,i=this;t=void 0!==t?t:this.selectMenuItemNum;var r=this.items[t],s=null===(e=r.dataset)||void 0===e?void 0:e.link;s||(s="/pages/"+r.innerHTML.toLowerCase()+".html"),this.target&&fetch(s).then((function(t){return t.text()})).then((function(t){var e=(new DOMParser).parseFromString(t,"text/html");if(i.target.innerHTML="",e.body){var n=i.target.appendChild(e.body);i._onLoadPage(n,s,r)}else i.target.innerHTML="Ressource "+s+" could not be loaded"})).catch((function(t){console.error("error loading ressource",r,t)})),null===(n=this.items[this.selectedMenuItemNum])||void 0===n||n.classList.remove("active"),this.selectedMenuItemNum=t,this.items[this.selectedMenuItemNum].classList.add("active")}},{key:"_onClickMenuItem",value:function(t){this.selectMenuItemNum(t)}},{key:"_onToggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.expanded=void 0!==t?t:!this.expanded;var e=[this.menu,this.target];this.attributes.permanent&&(e=this.children);for(var n=0;n<e.length;n++)e[n].classList.contains(this.attributes.permanent.value)||(this.expanded?e[n].classList.remove("hide"):e[n].classList.add("hide"));this.style.pointerEvents=this.expanded?"all":"none",this.onToggle&&this.onToggle(this.expanded)}},{key:"_onClick",value:function(t){this._onToggle()}}]),n}(f(HTMLElement));customElements.define("menu-sandwich",O);var M=1e3,j=60*M,_=60*j,D=24*_,R=7*D,B=365.25*D,z=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*B;case"weeks":case"week":case"w":return n*R;case"days":case"day":case"d":return n*D;case"hours":case"hour":case"hrs":case"hr":case"h":return n*_;case"minutes":case"minute":case"mins":case"min":case"m":return n*j;case"seconds":case"second":case"secs":case"sec":case"s":return n*M;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(t);if("number"===n&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=D)return q(t,e,D,"day");if(e>=_)return q(t,e,_,"hour");if(e>=j)return q(t,e,j,"minute");if(e>=M)return q(t,e,M,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=D)return Math.round(t/D)+"d";if(e>=_)return Math.round(t/_)+"h";if(e>=j)return Math.round(t/j)+"m";if(e>=M)return Math.round(t/M)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function q(t,e,n,i){var r=e>=1.5*n;return Math.round(t/n)+" "+i+(r?"s":"")}var H,G,U=function(t){function e(t){let i,r,s,o=null;function a(...t){if(!a.enabled)return;const n=a,r=Number(new Date),s=r-(i||r);n.diff=s,n.prev=i,n.curr=r,i=r,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let o=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((i,r)=>{if("%%"===i)return"%";o++;const s=e.formatters[r];if("function"==typeof s){const e=t[o];i=s.call(n,e),t.splice(o,1),o--}return i})),e.formatArgs.call(n,t);(n.log||e.log).apply(n,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(r!==e.namespaces&&(r=e.namespaces,s=e.enabled(t)),s),set:t=>{o=t}}),"function"==typeof e.init&&e.init(a),a}function n(t,n){const i=e(this.namespace+(void 0===n?":":n)+t);return i.log=this.log,i}function i(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(i),...e.skips.map(i).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),r=i.length;for(n=0;n<r;n++)i[n]&&("-"===(t=i[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,i;for(n=0,i=e.skips.length;n<i;n++)if(e.skips[n].test(t))return!1;for(n=0,i=e.names.length;n<i;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=z,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e},W=(H=function(t,e){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let i=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(i++,"%c"===t&&(r=i))})),e.splice(r,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=U(e);const{formatters:n}=t.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},H(G={exports:{}},G.exports),G.exports);W.formatArgs,W.save,W.load,W.useColors,W.storage,W.destroy,W.colors,W.log;var Y,$=W("app:log");function K(t){var e=document.getElementById("gallery");Y&&Y.destroy(),Y="Fader"==t?new T(e):"Roam"===t?new P(e):"Gallery"===t?new N(e):new x(e),window.gallery=Y,document.querySelectorAll(".requestFullscreen").forEach((function(t){Y.requestFullscreen(t,document.getElementById("fullscreenRoot"))})),document.querySelectorAll("menu-sandwich").forEach((function(t){t.onToggle=function(t){t?Y.dispatchEvent("PureStart"):Y.dispatchEvent("PureEnd")}})),document.querySelectorAll("button.topic").forEach((function(e){e.dataset.topic===t?e.classList.add("active"):e.classList.remove("active")}));var n=new URLSearchParams(window.location.search),i=Object.fromEntries(n.entries());Y.loadData("./data/meta.json").then((function(t){var e;t&&(Y.setMetaData(t),null===(e=document.querySelectorAll(".meta-title"))||void 0===e||e.forEach((function(e){return e.innerHTML=null==t?void 0:t.title})))})),Y.loadData("./data/albums.json").then((function(t){Y.setAlbums(t),Y.init(i),Y.run()})),Y.direction="random",Y.onPureStart=function(){console.log("pure start"),Y.onIdle(60)},Y.onPureEnd=function(){Y.onIdleEnd()},Y.onIdle=function(t){60==t&&document.querySelectorAll(".idleHide").forEach((function(t){t.classList.add("hide")}))},Y.onPauseStart=function(){J(!0)},Y.onPauseEnd=function(){J(!1)},Y.onIdleEnd=function(t){Y.pureMode||document.querySelectorAll(".idleHide").forEach((function(t){t.classList.remove("hide")}))},Y.onNavigation=function(t){document.querySelector("div.curtain")&&(document.querySelector("div.curtain").classList.add("hide"),setTimeout((function(){document.querySelector("div.curtain").classList.add("disabled"),document.body.removeChild(document.querySelector("div.curtain"))}),2e3),document.body.classList.remove("darkness")),Y.currentDirection={"-1":90,"+1":270}[t.target]||Y.currentDirection},Y.onResize=function(){var t="scale(1)";document.body.style.webkitTransform=t,document.body.style.msTransform=t,document.body.style.transform=t,Y.isFullscreen()||window.scrollTo(0,0)}}function J(t){document.querySelectorAll(".controls .button.toggle").forEach((function(e){console.log("update pause ",e),e.classList.add("stress"),t?e.classList.add("paused"):e.classList.remove("paused"),setTimeout((function(){e.classList.remove("stress")}),1e3)}))}W.enable("*"),$("Logging is enabled!"),document.querySelector("menu-sandwich").onLoadPage=function(t,e,n){var i=t.querySelector("form"),r=Y.getPreferences(!0);if(i)for(var s=0,o=Object.entries(r);s<o.length;s++){var a=y(o[s],2),u=a[0],l=a[1],c=i.querySelector('[name="'+u+'"]');if(c){if(c.options)for(var h=0;h<c.options.length;h++){var d=c.options[h];c.options[h].setAttribute("selected",d.value===l||Array.isArray(l)&&-1!==l.indexOf(d.value)?"selected":"")}c.value=l}}},window.onSubmitSettings=function(t,e){t.preventDefault();var n,i={},r=S(new FormData(e).entries());try{for(r.s();!(n=r.n()).done;){var s=y(n.value,2),o=s[0],a=s[1];i[o]?(Array.isArray(i[o])||(i[o]=[i[o]]),i[o].push(a)):i[o]=a}}catch(t){r.e(t)}finally{r.f()}for(var u=0,l=Object.entries(i);u<l.length;u++){var c=y(l[u],2),h=c[0],d=c[1];Y.set(h,d)}i["filters.safety"]&&(Y.applyFilters(),Y.setCurrentAlbumNum(0),Y.setCurrentImageNum(0),Y.init())},window.startTheme=K,document.addEventListener("DOMContentLoaded",(function(){K("dotgain"),document.querySelectorAll("button.topic").forEach((function(t){return t.addEventListener("click",(function(){return K(t.dataset.topic)}))})),document.querySelectorAll(".controls .button.toggle").forEach((function(t){return t.addEventListener("click",(function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;Y.setPaused(t)}()}))})),document.querySelectorAll(".controls .button.navi").forEach((function(t){return t.addEventListener("click",(function(){return e=t.dataset.target,void Y.navigate(e);var e}))}))}))}();
