!function(){"use strict";function t(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function e(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?t(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,i){t[e]=i.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function h(t,e,i,n){var s=e&&e.prototype instanceof v?e:v,o=Object.create(s.prototype),a=new S(n||[]);return r(o,"_invoke",{value:k(t,i,a)}),o}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var d={};function v(){}function f(){}function m(){}var g={};l(g,o,(function(){return this}));var p=Object.getPrototypeOf,y=p&&p(p(x([])));y&&y!==e&&n.call(y,o)&&(g=y);var b=m.prototype=v.prototype=Object.create(g);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(r,s,o,a){var u=c(t[r],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,a)}))}a(u.arg)}var s;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return s=s?s.then(r,r):r()}})}function k(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return T()}for(i.method=r,i.arg=s;;){var o=i.delegate;if(o){var a=I(o,i);if(a){if(a===d)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var u=c(t,e,i);if("normal"===u.type){if(n=i.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(n="completed",i.method="throw",i.arg=u.arg)}}}function I(t,e){var i=e.method,n=t.iterator[i];if(void 0===n)return e.delegate=null,"throw"===i&&t.iterator.return&&(e.method="return",e.arg=void 0,I(t,e),"throw"===e.method)||"return"!==i&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var s=r.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function x(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=m,r(b,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},E(w.prototype),l(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,n,r,s){void 0===s&&(s=Promise);var o=new w(h(e,i,n,r),s);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(b),l(b,u,"Generator"),l(b,o,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=x,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return o.type="throw",o.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),L(i),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;L(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:x(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},t}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e,i,n,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void i(t)}a.done?e(u):Promise.resolve(u).then(n,r)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function a(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e,i){return(e=L(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function v(t,e,i){return v=d()?Reflect.construct.bind():function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&c(r,i.prototype),r},v.apply(null,arguments)}function f(t){var e="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return v(t,arguments,h(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,t)},f(t)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){var e=d();return function(){var i,n=h(t);if(e){var r=h(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}(this,i)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?t:i):r.value}},p.apply(this,arguments)}function y(t,e){return E(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s,o,a=[],u=!0,l=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;u=!1}else for(;!(u=(n=s.call(i)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){l=!0,r=t}finally{try{if(!u&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw r}}return a}}(t,e)||w(t,e)||I()}function b(t){return E(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||w(t)||I()}function E(t){if(Array.isArray(t))return t}function w(t,e){if(t){if("string"==typeof t)return k(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=w(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw s}}}}function L(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var S=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;s(this,t),u(this,"canvas",void 0),this.canvas=e}return a(t,[{key:"draw",value:function(t){var e,i,n=t.canvas,r=void 0===n?void 0:n,s=t.position,o=void 0===s?{x:void 0,y:void 0}:s,a=t.outerRadius,u=void 0===a?80:a,l=t.innerRadius,h=void 0===l?40:l,c=t.numPoints,d=void 0===c?5:c,v=t.rotation,f=void 0===v?0:v,m=2*Math.PI/d;void 0===r&&(r=this.canvas);var g=r.getContext("2d"),p=null!==(e=o.x)&&void 0!==e?e:r.width/2,y=null!==(i=o.y)&&void 0!==i?i:r.height/2;g.beginPath(),g.moveTo(p+u*Math.cos(f*Math.PI/180),y+u*Math.sin(f*Math.PI/180));for(var b=0;b<d;b++){var E=b*m+f*Math.PI/180,w=p+u*Math.cos(E),k=y+u*Math.sin(E);g.lineTo(w,k);var I=(b+.5)*m+f*Math.PI/180,C=p+h*Math.cos(I),L=y+h*Math.sin(I);g.lineTo(C,L)}g.fillStyle="yellow",g.fill(),g.closePath()}}]),t}(),x=function(t){l(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return s(this,i),u(m(t=e.call(this)),"images",[]),u(m(t),"tabs",[]),u(m(t),"info",void 0),u(m(t),"selectedImageNum",void 0),u(m(t),"container",void 0),u(m(t),"list",void 0),u(m(t),"tabContainer",void 0),u(m(t),"listElements",[]),t.addEventListener("wheel",t._onScroll,{passive:!1}),t.setImages(n),t.setInfo(r),t.setTabs(a),t.selectedImageNum=o,t.render(),t}return a(i,[{key:"setTabs",value:function(t){this.tabs=t}},{key:"setImages",value:function(t){this.images=t}},{key:"setInfo",value:function(t){this.info=t}},{key:"getInfo",value:function(){return this.info}},{key:"select",value:function(t){void 0!==this.selectedImageNum&&this.listElements[this.selectedImageNum].classList.remove("selected");var e=this.listElements[t];if(e){var i=this.list.clientWidth/this.listElements[t].clientWidth||1,n=e.clientWidth,r=this.listElements[0].offsetLeft;e.offsetLeft,e.offsetLeft,this.list.scrollTo((t-i/2+1)*n-r,0),this.listElements[t].classList.add("selected"),this.selectedImageNum=t}else this.list.scrollTo(0,0);this.updateTabs()}},{key:"_onScroll",value:function(t){t.preventDefault(),this.list.scrollTo(this.list.scrollLeft+t.deltaY,0)}},{key:"_onSelectImage",value:function(t,e,i){this.onSelectImage&&this.onSelectImage(t,e,i),this.select(i)}},{key:"_onSelectTab",value:function(t,e,i){console.log("tab selected",e,i),this.onSelectTab&&this.onSelectTab(t,e,i)}},{key:"createFilmStripItems",value:function(t){for(var e=this,i=document.createElement("ul"),n=function(n){var r,s,o,a,u=document.createElement("li");e.selectedImageNum===n?u.classList.add("selected"):u.classList.remove("selected");var l,h=null===(r=t[n])||void 0===r?void 0:r.media;l="video"===h?document.createElement("video"):document.createElement("img");var c=null===(s=t[n])||void 0===s||null===(o=s.size)||void 0===o?void 0:o[h];c&&Array.isArray(c)?l.src=c[c.length-1]:l.src=c.src||t[n],l.addEventListener("click",(function(i){return e._onSelectImage(i,t[n],n)})),null!==(a=t[n])&&void 0!==a&&a.title&&l.setAttribute("title",t[n].title),u.appendChild(l),u.image=l,e.listElements[n]=u,i.appendChild(u)},r=0;r<t.length;r++)n(r);return i}},{key:"updateTabs",value:function(){var t,e,i=this,n=this.tabs;(this.tabContainer&&(this.tabContainer.innerHTML=""),n.length<1)&&(n=[{title:null===(t=this.info)||void 0===t?void 0:t.description,caption:null===(e=this.info)||void 0===e?void 0:e.title}]);for(var r=function(t){var e=n[t],r=document.createElement("div");r.classList.add("tab",t),e.class&&r.classList.add(e.class),r.innerHTML=e.caption||e.name||e.title||t,r.setAttribute("title",e.title||e.caption||e.name||t),r.addEventListener("click",(function(n){i._onSelectTab(n,e,t)})),i.tabContainer.appendChild(r)},s=0;s<n.length;s++)r(s)}},{key:"render",value:function(){var t=document.createElement("div");t.classList.add("filmStripContainer");var e=this.createFilmStripItems(this.images);t.appendChild(e),this.tabContainer=document.createElement("div"),this.tabContainer.classList.add("tabContainer"),this.updateTabs(),t.appendChild(this.tabContainer),this.replaceChildren(t),this.list=e,this.container=t}}]),i}(f(HTMLElement));customElements.define("film-strip",x);var T=function(t){l(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return s(this,i),u(m(t=e.call(this,void 0,void 0,r)),"albums",void 0),u(m(t),"selectedAlbumNum",void 0),t.setAlbums(n),t.selectedAlbumNum=o,t.selectedImageNum=r,t.render(),t}return a(i,[{key:"setAlbums",value:function(t){this.albums=t}},{key:"select",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;e!==this.selectedAlbumNum&&(this.selectedAlbumNum=e,this.render()),p(h(i.prototype),"select",this).call(this,t)}},{key:"getAlbum",value:function(t){var e;return void 0===t&&(t=this.selectedAlbumNum),null===(e=this.albums)||void 0===e?void 0:e[t]}},{key:"_onSelectImage",value:function(t,e,i){void 0!==e.photoset?this.select(e.titleImageNum,e.photoset):this.select(i,this.selectedAlbumNum),this.onSelectImage&&this.onSelectImage(t,this.selectedImageNum,this.selectedAlbumNum)}},{key:"_onSelectTab",value:function(t,e,i){0===i&&this.select(void 0,void 0)}},{key:"updateTabs",value:function(){var t=this.getAlbum(),e=[{name:"Albums",title:"Browse existing albums"}];if(t){var n;e.push({name:t.title,class:"currentAlbum",title:t.description||t.title});var r=null===(n=t.photos)||void 0===n?void 0:n[this.selectedImageNum];r&&e.push({name:r.title,class:"currentImage",title:r.description||r.title})}this.setTabs(e),p(h(i.prototype),"updateTabs",this).call(this)}},{key:"render",value:function(){var t=this.getAlbum();if(t?this.images!==t.photos&&(this.images=t.photos):this.albums&&(this.images=this.getAlbumTitleImages()),this.images&&(p(h(i.prototype),"render",this).call(this),!t))for(var e=0;e<this.images.length;e++)this.listElements[e].image.setAttribute("title",this.images[e].photosetTitle)}},{key:"getAlbumList",value:function(){for(var t=[],e=0;e<this.albums.length;e++){for(var i=this.albums[e],n=0;n<i.photos.length;n++)i.photos[n].id===i.primary&&(i.titleImage=i.photos[n],i.titleImageNum=n);void 0===i.titleImage&&(i.titleImage=i.photos[0],i.titleImageNum=0),t.push(i)}return t}},{key:"getAlbumTitleImages",value:function(){for(var t=this.getAlbumList(),e=[],i=0;i<t.length;i++){var n=t[i].titleImage;n.photoset=i,n.photosetTitle=t[i].title,n.titleImageNum=t[i].titleImageNum,e.push(n)}return e}}]),i}(x);customElements.define("album-strip",T);var P=function(t){l(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return s(this,i),u(m(t=e.call(this)),"listItems",void 0),t.listItems=n,t.render(),t}return a(i,[{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e=e||this.listItems;var i=function(){if(e[n]){var i=document.createElement("li");i.classList.add(n);var r=document.createElement("div");r.classList.add("label");var s=document.createElement("span");s.innerHTML=n,r.appendChild(s),i.appendChild(r),(r=document.createElement("div")).classList.add("value"),Array.isArray(e[n])||(e[n]=[e[n]]),e[n].forEach((function(t){t instanceof Element?r.appendChild(t):((s=document.createElement("span")).innerHTML=t,r.appendChild(s))})),i.appendChild(r),t.appendChild(i)}};for(var n in e)i()}}]),i}(f(HTMLElement));customElements.define("ul-tags",P);var A=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;s(this,t),u(this,"context",void 0),u(this,"listeners",void 0),this.setContext(e),i&&(this.setListeners(i),this.init())}return a(t,[{key:"setContext",value:function(t){this.context=t}},{key:"setListeners",value:function(t){this.listeners=t}},{key:"destroy",value:function(){}},{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.listeners,n=!0===e?"removeEventListener":"addEventListener";if(Array.isArray(i));else for(var r=0,s=Object.keys(i);r<s.length;r++){var o=s[r],a=i[o],u=void 0;switch(o){case"document":u=document;break;case"window":u=window;break;case"context":u=this.context;break;default:u=document.querySelector(o)}var l,h=C(a);try{var c=function(){var e=l.value;Array.isArray(e)?u[n](e[0].toLowerCase(),(function(i){return t.fire(e[1],i)})):u[n](e.toLowerCase(),(function(i){return t.fire(e,i)}))};for(h.s();!(l=h.n()).done;)c()}catch(t){h.e(t)}finally{h.f()}}this.listeners=i}},{key:"fire",value:function(t){for(var e,i,n,r="on"+t,s="_on"+t,o=arguments.length,a=new Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];"function"==typeof this.context.onEvent&&(e=this.context).onEvent.apply(e,[t].concat(a));"function"==typeof this.context[s]&&(i=this.context)[s].apply(i,a);"function"==typeof this.context[r]&&(n=this.context)[r].apply(n,a)}}]),t}(),M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;s(this,t),u(this,"dispatcher",void 0),u(this,"element",void 0),u(this,"listeners",{document:["TouchStart","TouchEnd","TouchCancel","MouseDown","MouseUp"]}),u(this,"touches",[]),u(this,"mouse",{}),this.dispatcher=new A(this,this.listeners),this.element="string"==typeof e?document.querySelector(e):e}return a(t,[{key:"getTouchNum",value:function(t){for(var e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return e}},{key:"_onMouseDown",value:function(t){this.mouse={x:t.x,y:t.y,t:t.timeStamp,target:t.target},this.dispatcher.fire("MouseStart",this.mouse,t)}},{key:"_onMouseUp",value:function(t){this.mouse.x2=t.x,this.mouse.y2=t.y,this.mouse.t2=t.timeStamp,this.mouse.dx=this.mouse.x2-this.mouse.x,this.mouse.dy=this.mouse.y2-this.mouse.y,this.mouse.dt=this.mouse.t2-this.mouse.t,this.dispatcher.fire("MouseEnd",this.mouse,t)}},{key:"_onTouchStart",value:function(t){for(var e=t.changedTouches,i=0;i<e.length;i++){var n=e[i];this.touches.push({id:n.identifier,x:n.pageX,y:n.pageY,target:t.target,t:t.timeStamp}),1===this.touches.length&&this.dispatcher.fire("FirstTouch",n,t)}}},{key:"_onTouchEnd",value:function(t){for(var e=t.changedTouches,i=0;i<e.length;i++){var n=e[i],r=this.getTouchNum(n.identifier),s=this.touches[r];1===this.touches.length&&this.dispatcher.fire("LastTouch",{x:s.x,y:s.y,x2:n.pageX,y2:n.pageY,dx:n.pageX-s.x,dy:n.pageY-s.y,t:s.t,t2:t.timeStamp,dt:t.timeStamp-s.t},t),this.touches.splice(r,1)}}},{key:"_onTouchCancel",value:function(t){for(var e=t.changedTouches,i=0;i<e.length;i++){var n=this.getTouchNum(e[i].identifier);this.touches.splice(n,1)}}}]),t}(),N=function(){function t(){s(this,t)}return a(t,null,[{key:"matchAgainst",value:function(t,e){return function t(e,i){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if((r=i)instanceof Object||"object"==n(r))for(var a=0,u=Object.entries(i);a<u.length;a++){var l=y(u[a],2);l[0];var h=y(t(e,l[1],s,o),2);s=h[0],o=h[1]}else if(function(t){return Array.isArray(t)}(i))for(var c=0;c<i.length;c++){var d=y(t(e,i[c],s,o),2);s=d[0],o=d[1]}else(function(t){return t instanceof String||"string"==typeof t})(i)&&(s+=i.split(e).length-1);return[s,o]}(t,e)}}]),t}(),F=function(t){l(d,t);var o,h,c=g(d);function d(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return s(this,d),u(m(e=c.call(this)),"svgNS","http://www.w3.org/2000/svg"),u(m(e),"meta",{title:"Chameleon | Image Gallery",delimiter:" | "}),u(m(e),"preferences",{breakTimeDuration:10,userIdleTimeDuration:7.5,transitionDuration:2,showCursorDuration:10,filters:{safety:["0","1"]},width:void 0,height:void 0,direction:"random",fps:20,shuffle:0,pauseMode:"smooth",videoStyle:(t={marginLeft:"auto",objectFit:"cover",position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},u(t,"top",0),u(t,"left",0),u(t,"alignment",{x:.5,y:.5}),t),videoLayerStyle:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0)"},imgStyle:{marginLeft:"auto",marginRight:"auto",objectFit:"contain",width:"100%",height:"100%",position:"absolute",top:0,left:0,alignment:{x:.5,y:.5}},imgLayerStyle:{opacity:0,position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,1)"},changeAlbumOnImageNumOverflow:!0}),u(m(e),"transitionFrame",0),u(m(e),"breakTimeFrame",0),u(m(e),"totalFrames",0),u(m(e),"suspended",!1),u(m(e),"afterTransition",void 0),u(m(e),"workload",0),u(m(e),"timer",[Date.now()]),u(m(e),"keysPressed",[]),u(m(e),"paused",!1),u(m(e),"userIdleTime",0),u(m(e),"pureMode",!1),u(m(e),"firstRun",!0),u(m(e),"userMove",{}),u(m(e),"albums",[]),u(m(e),"img",[]),u(m(e),"imageLayersMax",2),u(m(e),"imageContainer",void 0),u(m(e),"previousImage",void 0),u(m(e),"currentImageNum",0),u(m(e),"currentAlbumNum",0),u(m(e),"shufflePosition",0),u(m(e),"canvasContainer",void 0),u(m(e),"canvas",void 0),u(m(e),"mask",void 0),u(m(e),"imageInfoBox",void 0),u(m(e),"filmStrip",void 0),u(m(e),"dispatcher",void 0),u(m(e),"listeners",{document:["MouseMove","KeyUp","KeyDown"],window:["Resize",["orientationchange","Resize"],"Offline","Online"]}),u(m(e),"overlays",{imageInfoBox:{autostart:2.5,duration:5,idleEnd:!0,idleMax:5,pauseHide:!0},filmStrip:{autostart:!1,idleEnd:!0,idleMax:5,pauseHide:!0}}),i&&e.setAlbums(i),n&&e.setPreferences(n),e.dispatcher=new A(m(e),e.listeners),e.dispatcher.fire("Resize"),e}return a(d,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t in this.preferences||console.warn('preference "'+t+'" not found'),this.preferences[t]||e}},{key:"read",value:function(t){var e,i=t.split("."),n=this.preferences,r=C(i);try{for(r.s();!(e=r.n()).done;){var s,o=e.value;n=null===(s=n)||void 0===s?void 0:s[o]}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"set",value:function(t,i){var n=function t(i,n,r){var s=b(n.split(".")),o=s[0],a=s.slice(1);return e(e({},i),{},u({},o,a.length?t(i[o],a.join("."),r):r))}(this.preferences,t,i);return this.preferences=n,n}},{key:"importPreferences",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"p.",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"[]",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:",";if(t){for(var r=0,s=Object.entries(t);r<s.length;r++){var o=y(s[r],2),a=o[0],u=o[1];0===a.indexOf(e)&&((a=a.substring(e.length)).substring(a.length-i.length)===i&&(a=a.substring(0,a.length-i.length),u=u.split(n)),("string"==typeof u||u instanceof String)&&("true"===u.toLowerCase()?u=!0:"false"===u.toLowerCase()&&(u=!1)),this.set(a,u))}this.applyFilters()}}},{key:"setPreferences",value:function(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.preferences?this.preferences=e(e({},this.preferences),t):this.preferences=t}},{key:"getPreferences",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var t=function(t){return!isNaN(t)||t instanceof String||"string"==typeof t};return function e(i){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=0,o=Object.entries(i);s<o.length;s++){var a=y(o[s],2),u=a[0],l=a[1],h=r.concat(u);Array.isArray(l)&&l.some(t)?n[h.join(".")]=l:l instanceof Object?e(l,n,r.concat(u)):n[h.join(".")]=l}return n}(this.preferences)}return this.preferences}},{key:"destroy",value:function(){this.removeChild(this.canvasContainer),this.dispatcher.destroy(),this.run=void 0}},{key:"requestFullscreen",value:function(t,e){var i=this;t.addEventListener("click",(function(){document.fullscreenElement?document.exitFullscreen():e.requestFullscreen?e.requestFullscreen(e):e.mozRequestFullScreen?e.mozRequestFullScreen(e):e.webkitRequestFullscreen?e.webkitRequestFullscreen(e):e.msRequestFullscreen&&e.msRequestFullscreen(e)})),addEventListener("fullscreenchange",(function(t){i.dispatchEvent("FullscreenChange",t)}))}},{key:"isFullscreen",value:function(){return window.fullScreen||window.innerWidth==screen.width&&window.innerHeight==screen.height}},{key:"dispatchEvent",value:function(t,e){this.dispatcher.fire(t,e)}},{key:"navigate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"+1",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"+0";if(this.isPaused()&&this.dispatchEvent("PauseEnd"),1!=this.get("shuffle")||void 0!==t&&(null!=t&&t.album||null!=t&&t.image||!isNaN(t))&&(!("string"==typeof t||t instanceof String)||!["+","-"].indexOf(-1!==(t||0).substring(0,1))))if("object"===n(t)||void 0===t){if(t.album&&this.setCurrentAlbumNum(this.getAlbumNumByPropertyValue(t.album)),t.image){var i=this.getImageNumByPropertyValue(t.image);i&&(this.setCurrentAlbumNum(i.album),this.setCurrentImageNum(i.image))}}else void 0!==e&&this.setCurrentAlbumNum(parseInt(e)+(("string"==typeof e||e instanceof String)&&["+","-"].indexOf(-1!==(e||0).substring(0,1))?this.getCurrentAlbumNum():0)),void 0!==t&&this.setCurrentImageNum(parseInt(t)+(("string"==typeof t||t instanceof String)&&["+","-"].indexOf(-1!==(t||0).substring(0,1))?this.getCurrentImageNum():0));else this.setShufflePosition(parseInt(t)+(("string"==typeof t||t instanceof String)&&["+","-"].indexOf(-1!==(t||0).substring(0,1))?this.getShufflePosition():0));this.updateTitle(),this.firstRun&&(this.transitionFrame=void 0,this.firstRun=!1,this.suspended=!0),void 0===this.transitionFrame?this.startTransition():this.afterTransition=this.startTransition,this.filmStrip.select(this.currentImageNum,this.currentAlbumNum),this.dispatchEvent("Navigation",{target:this.currentImageNum})}},{key:"startTransition",value:function(){this.suspended=!0,this.transitionFrame=void 0,this.breakTimeFrame=0,this.currentDirection="random"===this.get("direction")?360*Math.random():this.get("direction"),this.updateClipPathTransition(),this.showImage(this.getCurrentImage(),this.getImageSrc(this.getCurrentImage())),this.dispatchEvent("TransitionStart")}},{key:"getCurrentImage",value:function(){return this.getAlbumImages()[this.currentImageNum]}},{key:"getImage",value:function(t){return this.getAlbumImages()[t]}},{key:"setCurrentAlbumNum",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0!==t&&t!==this.currentAlbumNum&&(this.currentAlbumNum=t%this.albums.length<0?t%this.albums.length+this.albums.length:t%this.albums.length,this.updateFilmStrip()),void 0!==e&&e!==this.currentImageNum&&this.setCurrentImageNum(e),this.currentAlbumNum}},{key:"setShufflePosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.shuffleIndex||(this.shuffleIndex=this.getShuffleIndex(),this.dispatchEvent("ShuffleIndexCreated",this.index)),this.shufflePosition=(t||0+this.shuffleIndex.length)%this.shuffleIndex.length;var e=this.shuffleIndex[this.shufflePosition];this.setCurrentAlbumNum(e.albumNum),this.setCurrentImageNum(e.imageNum)}},{key:"getShufflePosition",value:function(){return this.shufflePosition}},{key:"getAlbum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return this.albums[t||this.currentAlbumNum]}},{key:"getAlbumInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i=e({},this.albums[t||this.currentAlbumNum]);return delete i.images,i}},{key:"getCurrentAlbumNum",value:function(){return this.currentAlbumNum}},{key:"getAlbumImages",value:function(){var t,e,i,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return(null===(t=this.albums[r||this.currentAlbumNum])||void 0===t?void 0:t.photos)||(null===(e=this.albums)||void 0===e?void 0:e.photos)||this.photos||(null===(i=this.albums[r||this.currentAlbumNum])||void 0===i?void 0:i.images)||(null===(n=this.albums)||void 0===n?void 0:n.images)||this.albums}},{key:"getImageSrc",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if("string"==typeof t||t instanceof String)return t;n=null!==(e=n)&&void 0!==e?e:null==t?void 0:t.media;try{return(null==t?void 0:t.src)||(null==t?void 0:t.size[n][i])}catch(e){console.log("image #"+(t.id||t.title)+" does not provide src/sizes",e,t)}}},{key:"setCurrentImageNum",value:function(t){this.get("changeAlbumOnImageNumOverflow")&&(t>=this.getAlbumImages().length?(this.setCurrentAlbumNum(this.getCurrentAlbumNum()+1),t=0):t<0&&this.setCurrentAlbumNum(this.getCurrentAlbumNum()-1));var e=this.getAlbumImages();return this.currentImageNum=(t%e.length<0?t%e.length+e.length:t%e.length)||0}},{key:"getCurrentImageNum",value:function(){return this.currentImageNum}},{key:"setMetaData",value:function(t){this.meta=e(e({},this.meta),t),this.updateTitle()}},{key:"sanitize",value:function(t){return t.replace(/[ \/]{1,}/gi,"-")}},{key:"updateTitle",value:function(){var t,e,i,n,r=(null===(t=this.getAlbum())||void 0===t?void 0:t.title)||(null===(e=this.getAlbum())||void 0===e?void 0:e.name),s=(null===(i=this.getCurrentImage())||void 0===i?void 0:i.title)||(null===(n=this.getCurrentImage())||void 0===n?void 0:n.name);if(document.title=this.meta.title+this.meta.delimiter+r+this.meta.delimiter+s,!this.isFullscreen()&&r&&s){var o=location.protocol+"//"+location.host+"/album/"+this.sanitize(r)+"/"+this.sanitize(s)+location.search;console.log(o);var a=new URL(o);history.pushState({},"",a)}}},{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;!0!==(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.get("width")||this.get("height"))||this.dispatchEvent("Resize"),this.canvasContainer&&this.removeChild(this.canvasContainer),this.importPreferences(e),this.createCanvasContainer(),this.createInfoBox(),this.createFilmStrip(!0),this.navigate(e||this.currentImageNum),this.swiper=new M,this.swiper.onEvent=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.dispatchEvent.apply(t,[e].concat(n))}}},{key:"updateOverlays",value:function(){for(var t=0,e=Object.keys(this.overlays);t<e.length;t++){var i=e[t],n=this.overlays[i];this.pureMode||this.transitionFrame||this.suspended||!(n.autostart>0&&this.breakTimeFrame===n.autostart*this.get("fps")||this.breakTimeFrame>0&&!0===n.idleEnd&&0===this.userIdleTime)?(this.pureMode||n.idleMax*this.get("fps")===this.userIdleTime&&(!n.duration||this.breakTimeFrame>n.duration*this.get("fps")))&&this[i].classList.add("hide"):this[i].classList.remove("hide")}}},{key:"update",value:function(){this.userIdleTime++,this.userIdleTime%20==0&&this.dispatchEvent("Idle",this.userIdleTime),this.isPaused()||(void 0!==this.transitionFrame?(this.transitionFrame++,this.breakTimeFrame=0):this.suspended||this.breakTimeFrame++,this.updateClipPathTransition()),this.breakTimeFrame>this.get("breakTimeDuration")*this.get("fps")&&this.userIdleTime>this.get("userIdleTimeDuration")*this.get("fps")&&!this.suspended&&this.navigate("+1")}},{key:"updateClipPathTransition",value:function(){if(this.transitionFrame>this.get("transitionDuration")*this.get("fps"))this.dispatchEvent("TransitionEnd");else if(this.transitionFrame)for(var t=1/this.get("transitionDuration")/this.get("fps"),e=0;e<this.img.length;e++){var i=this.img[e];i.style.opacity<1&&(i.style.opacity=parseFloat(i.style.opacity)+t),i.style.zIndex=this.img.length-e}}},{key:"updateFilmStrip",value:function(){this.filmStrip.setImages(this.getAlbumImages()),this.filmStrip.setInfo(this.getAlbumInfo()),this.filmStrip.render()}},{key:"run",value:function(){var t=this;this.isPaused()&&(this.paused++,this.dispatchEvent("Paused",this.paused)),this.updateOverlays(),this.update(),this.userIdleTime===this.get("showCursorDuration")*this.get("fps")&&(document.body.style.cursor="none"),this.totalFrames++,requestAnimationFrame?requestAnimationFrame((function(){return t.run()})):setTimeout((function(){return t.run()}),1e3/this.get("fps"))}},{key:"getImageNumByPropertyValue",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","title"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;("string"==typeof i||i instanceof String)&&(i=[i]),n=null!==(e=n)&&void 0!==e?e:this.getCurrentAlbumNum();for(var r=-1;r<this.albums.length;r++){var s=-1===r?n:r;if(void 0!==r)for(var o=this.albums[s].photos||this.albums[s].images,a=0;a<o.length;a++){var u,l=o[a],h=C(i.values());try{for(h.s();!(u=h.n()).done;){var c=u.value;if(l[c]==t||this.sanitize(l[c])==t)return{album:s,image:a}}}catch(t){h.e(t)}finally{h.f()}}}console.error("image "+t+" not found")}},{key:"getAlbumNumByPropertyValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["id","title"];("string"==typeof e||e instanceof String)&&(e=[e]);for(var i=0;i<this.albums.length;i++){var n,r=C(e.values());try{for(r.s();!(n=r.n()).done;){var s=n.value;if(this.albums[i][s]==t||this.sanitize(this.albums[i][s])==t)return i}}catch(t){r.e(t)}finally{r.f()}}console.error("album "+t+" not found")}},{key:"loadData",value:(o=i().mark((function t(){var e,n=this,r=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:"./data/albums.json",t.abrupt("return",fetch(e).then((function(t){return t.json()})).catch((function(t){n.dispatchEvent("Error",void 0,t)})));case 2:case"end":return t.stop()}}),t)})),h=function(){var t=this,e=arguments;return new Promise((function(i,n){var s=o.apply(t,e);function a(t){r(s,i,n,a,u,"next",t)}function u(t){r(s,i,n,a,u,"throw",t)}a(void 0)}))},function(){return h.apply(this,arguments)})},{key:"getFilteredResults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;i=i||this.loadedAlbums||this.albums,t=e(e({},this.get("filters")),t);for(var n=[],r=[],s=0;s<i.length;s++){var o=e({},i[s]);o.photos=[];for(var a=0;a<i[s].photos.length;a++){var u,l,h=i[s].photos[a],c=0,d=0;if(-1!==(null===(u=t)||void 0===u?void 0:u.safety.indexOf(h.safety))&&(c=1),c&&null!==(l=t)&&void 0!==l&&l.searchterm){var v,f=y(N.matchAgainst(null===(v=t)||void 0===v?void 0:v.searchterm,h),2);c=f[0],d=f[1]}c&&(h._searchScore=d,h._searchMatches=c,o.photos.push(h),r.push(h))}o.photos.length>0&&n.push(o)}return{albums:n,photos:r}}},{key:"applyFilters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.albums=this.getFilteredResults(t,e).albums,this.index=this.getIndex(),this.dispatchEvent("FilterApplied")}},{key:"resetFilters",value:function(){this.albums=this.loadedAlbums,this.dispatchEvent("FilterReset")}},{key:"setAlbums",value:function(t){this.loadedAlbums=t,this.applyFilters(),this.dispatchEvent("IndexCreated")}},{key:"getShuffleIndex",value:function(t){return(t=t||this.index)||(t=this.getIndex()),t.sort((function(t,e){return.5-Math.random()}))}},{key:"getIndex",value:function(t){var e=[];t=t||this.albums||this.loadedAlbums;for(var i=0;i<t.length;i++)for(var n=0;n<t[i].photos.length;n++){var r=t[i].photos[n],s={id:r.id,title:r.title,num:n};s.albumNum=i,s.imageNum=n,s.albumId=t[i].id,s.albumTitle=t[i].title,e.push(s)}return e}},{key:"getImageSlot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return document.getElementById("imageSlot"+(void 0!==t?t:this.albumslots.length-1))}},{key:"isPaused",value:function(){return this.paused>0}},{key:"setPaused",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0===e&&(e=!this.paused),!0===e?this.transitionFrame&&!this.isPaused()?(this.afterTransition=function(){return t.dispatchEvent("PauseStart")},this.userIdleTime=this.infoBoxDuration*this.get("fps")-1):this.dispatchEvent("PauseStart"):this.dispatchEvent("PauseEnd"),e}},{key:"_onFullscreenChange",value:function(t){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||t.preventDefault()}},{key:"_onMouseEnd",value:function(t){if(t.y2>0&&t.x2>0&&t.dt>50&&t.dt<4e3){if(t.dx>50)return this.navigate("-1","+0");if(t.dx<-50)return this.navigate("+1","+0");if(t.dy>50)return this.navigate("+0","-1");if(t.dy<-50)return this.navigate("+0","+1")}this.imageContainer.contains(t.target)&&this.togglePureMode()}},{key:"_onLastTouch",value:function(t,e){if(t.y2>0&&t.x2>0&&t.dt>50&&t.dt<4e3){if(t.dx>50)return this.navigate("-1","+0");if(t.dx<-50)return this.navigate("+1","+0");if(t.dy>50)return this.navigate("+0","-1");if(t.dy<-50)return this.navigate("+0","+1")}this.togglePureMode()}},{key:"_onTouchStart",value:function(t){this.dispatchEvent("IdleEnd")}},{key:"_onScroll",value:function(t){this.dispatchEvent("IdleEnd")}},{key:"_onPureStart",value:function(){this.pureMode=!0}},{key:"_onPureEnd",value:function(){this.pureMode=!1,this.dispatchEvent("IdleEnd")}},{key:"togglePureMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.pureMode||!1===t?this.dispatchEvent("PureEnd"):this.dispatchEvent("PureStart")}},{key:"_onKeyUp",value:function(t){switch("Escape"===t.key?this.togglePureMode():" "===t.key?this.setPaused():-1===this.keysPressed.indexOf("Shift")&&this.dispatchEvent("IdleEnd",this.userIdleTime),t.key){case"ArrowRight":this.navigate("+1");break;case"ArrowLeft":this.navigate("-1");break;case"ArrowUp":this.navigate(0,"-1");break;case"ArrowDown":this.navigate(0,"+1")}-1!==this.keysPressed.indexOf(t.key)&&this.keysPressed.splice(this.keysPressed.indexOf(t.key),1)}},{key:"_onPauseEnd",value:function(){this.paused=0}},{key:"_onPauseStart",value:function(){var t,e;(this.paused=1,this.overlays.imageInfoBox.pauseHide)&&(null===(t=this.imageInfoBox)||void 0===t||t.classList.add("hide"));this.overlays.filmStrip.pauseHide&&(null===(e=this.filmStrip)||void 0===e||e.classList.add("hide"))}},{key:"_onResize",value:function(t){var e;this.set("width",this.clientWidth||this.width||document.clientWidth||800),this.set("height",this.clientHeight||this.height||document.clientHeight||600),null===(e=this.canvas)||void 0===e||e.setAttribute("viewBox","0 0 "+this.get("width")+" "+this.get("height")),console.debug("canvas size: "+this.get("width")+"x"+this.get("height")+" fullscreen: "+this.isFullscreen());var i=this.getImageSlot(1);i&&(i.background.setAttributeNS(null,"width",this.get("width")),i.background.setAttributeNS(null,"height",this.get("height")))}},{key:"_onIdleEnd",value:function(){this.userIdleTime>0&&(this.userIdleTime=0,document.body.style.cursor="auto")}},{key:"_onMouseMove",value:function(){this.dispatchEvent("IdleEnd",this.userIdleTime),this.userIdleTime=0}},{key:"_onTransitionStart",value:function(){this.imageInfoBox.classList.add("hide")}},{key:"_onTransitionEnd",value:function(){this.showImageInfo(),this.transitionFrame=void 0,this.breakTimeFrame=0,this.suspended=!1,this.paused&&this.setPaused(!0),this.afterTransition&&(this.afterTransition(),this.afterTransition=void 0)}},{key:"_onError",value:function(t){this.showMessage("An error occurred",t),console.error(t)}},{key:"_onOnline",value:function(){this.navigate("+0","+0")}},{key:"_onOffline",value:function(t){console.log("offline",t)}},{key:"_onMediaReady",value:function(){this.suspended&&(this.suspended=!1,this.transitionFrame=0)}},{key:"_onImageLoad",value:function(t){this.dispatchEvent("MediaReady",t)}},{key:"_onVideoLoaded",value:function(t){this.img[0].video=t.target,this.dispatchEvent("VideoPlay",t)}},{key:"_onVideoPlay",value:function(t){var e,i=this,n=null!==(e=null==t?void 0:t.target)&&void 0!==e?e:this.img[0].video;n instanceof HTMLVideoElement&&0===n.currentTime&&n.play().then((function(){i.dispatchEvent("MediaReady")})).catch((function(t){i.dispatchEvent("RequireInteraction",n),console.warn("video could not be played",t)}))}},{key:"setProps",value:function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i],s=e[r];t[r]=s}}},{key:"showMessage",value:function(t){console.error(t)}},{key:"createMediaElement",value:function(){var t,e,i=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return"video"===(n=null!==(t=n)&&void 0!==t?t:this.getCurrentImage()).media?((e=document.createElement("video")).addEventListener("loadeddata",(function(t){return i.dispatchEvent("VideoLoading",t)})),e.addEventListener("play",(function(t){return i.dispatchEvent("MediaReady",t)})),e.addEventListener("canplaythrough",(function(t){return i.dispatchEvent("VideoLoaded",t)})),e.setAttribute("autoplay",""),e.setAttribute("muted",""),e.setAttribute("loop",""),e.setAttribute("playsinline",""),e.src=this.getImageSrc(n,1),this.setProps(e.style,this.get("videoStyle"))):((e=document.createElement("img")).addEventListener("load",(function(t){return i.dispatchEvent("ImageLoad",t)})),e.src=this.getImageSrc(n),this.setProps(e.style,this.get("imgStyle"))),this.dispatchEvent("Debug",e.src),e.addEventListener("error",(function(t){return i.dispatchEvent("Error",t)})),e}},{key:"showImage",value:function(){var t=document.createElement("div"),e=this.createMediaElement();t.appendChild(e),this.setProps(t.style,this.get(e instanceof HTMLVideoElement?"videoLayerStyle":"imgLayerStyle")),this.addImageLayer(t)}},{key:"addImageLayer",value:function(t){this.img.unshift(t),this.setProps(t.style.zIndex,this.img.length+1),this.imageContainer.insertBefore(t,this.imageContainer.firstChild);for(var e=this.imageLayersMax;e<this.imageContainer.children.length;e++)this.imageContainer.removeChild(this.imageContainer.children[e]),this.img.pop()}},{key:"createCanvasContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div";this.canvasContainer=document.createElement(t),this.appendChild(this.canvasContainer),this.setProps(this.canvasContainer.style,{width:"100%",height:"100%",position:"absolute"}),this.canvasContainer.setAttribute("class","canvasContainer"),this.imageContainer=document.createElement("div"),this.imageContainer.setAttribute("class","imageContainer"),this.canvasContainer.appendChild(this.imageContainer)}},{key:"createFilmStrip",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.filmstrip&&!e||(this.filmStrip=new T(this.albums,this.currentImageNum,this.currentAlbumNum),this.filmStrip.classList.add("filmStrip","hide"),this.filmStrip.onSelectImage=function(e,i,n){t.navigate(i,n)}),this.canvasContainer.appendChild(this.filmStrip)}},{key:"createInfoBox",value:function(){if(!this.imageInfoBox){var t=document.createElement("div");t.classList.add("infoBox","hide"),t.onclick=function(e){t.classList.toggle("minified")},this.imageInfoBox=t}this.canvasContainer.appendChild(this.imageInfoBox)}},{key:"showImageInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.afterTransition||t){var i=this.imageInfoBox;t&&i.classList.remove("hide");var n=this.getCurrentImage();if("string"==typeof n||n instanceof String||0===Object.keys(n).length){var r=document.createElement("div");r.classList.add("noInfo"),r.innerHTML="No Information available",i.replaceChildren(r)}else{var s,o,a,u,l;if(null===(s=n=e({},this.getCurrentImage()))||void 0===s||delete s.src,n.camera){var h,c,d={camera:n.camera,lens:(null===(h=n.exif)||void 0===h?void 0:h.LensModel)||(null===(c=n)||void 0===c?void 0:c.Lens)};(u=new P(d)).classList.add("imageExif")}if(n.exif){var v,f,m,g,p,y,b={exposure:null===(v=n.exif)||void 0===v?void 0:v.ExposureTime,aperture:null===(f=n.exif)||void 0===f?void 0:f.FNumber,focus:null===(m=n.exif)||void 0===m?void 0:m.FocalLength,iso:null===(g=n.exif)||void 0===g?void 0:g.ISO};if(null!==(p=n.exif)&&void 0!==p&&p.Flash)"on"===(null===(y=n.exif)||void 0===y?void 0:y.Flash.substring(0,2).toLowerCase())?b.flash="on":b.noflash="off";(l=new P(b)).classList.add("imageExif")}var E={title:n.title,album:this.getAlbum().title,description:n.description,location:n.location,tags:n.tags,date:null===(o=n.dates)||void 0===o?void 0:o.taken,posted:null===(a=n.dates)||void 0===a?void 0:a.posted,gear:u,exif:l},w=new P(E);w.classList.add("imageInfo"),i.replaceChildren(w)}}}}]),d}(f(HTMLElement));customElements.define("chameleon-gallery",F);var O=function(t){l(i,t);var e=g(i);function i(t){return s(this,i),e.call(this,t)}return a(i,[{key:"drawImage",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t instanceof HTMLCanvasElement){var n,r,s=t.getContext("2d"),o=this.canvasContainer.clientWidth,a=this.canvasContainer.clientHeight,u=this.get(e instanceof HTMLVideoElement?"videoStyle":"imgStyle");i&&(t.style.transform="scale("+i+","+i+")");var l=null!==(n=e.videoHeight)&&void 0!==n?n:e.height,h=null!==(r=e.videoWidth)&&void 0!==r?r:e.width;-1!==["contain","cover"].indexOf(u.objectFit)&&(a=(o=o*l/h<=a||"cover"===u.objectFit?o:a*h/l)/h*l),s.drawImage(e,(t.width-o)*u.alignment.x,(t.height-a)*u.alignment.y,o,a)}}},{key:"_onTransitionEnd",value:function(){var t;this.replaceCanvasWithDiv();for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=p(h(i.prototype),"_onTransitionEnd",this)).call.apply(t,[this].concat(n))}},{key:"replaceCanvasWithDiv",value:function(){if(this.img[0]instanceof HTMLCanvasElement){var t,e=document.createElement("div"),i=null!==(t=this.img[0].video)&&void 0!==t?t:this.img[0].image,n=this.img[0];e.appendChild(i),e.image=i,e.frame=n.frame,this.addImageLayer(e),this.setProps(e.style,this.preferences[i instanceof HTMLVideoElement?"videoLayerStyle":"imgLayerStyle"]),e.classList.add(i instanceof HTMLVideoElement?"video":"image"),e.style.backgroundColor="rgb(0,0,0)",e.style.opacity=1,e.style.transition="opacity 2s",this.img[1].classList.add("hide"),this.img[1].style.opacity="inherit"}}},{key:"_onImageLoad",value:function(t){var e=this,n=t.target,r=this.get("imgStyle"),s=this.canvasContainer.clientWidth,o=this.canvasContainer.clientHeight;o=(s=s*n.height/n.width<=o||"cover"===r.objectFit?s:o*n.width/n.height)/n.width*n.height,"function"==typeof createImageBitmap?createImageBitmap(n,{resizeWidth:s,resizeHeight:o,resizeQuality:"high"}).then((function(n){e.img[0].bitmap=n,p(h(i.prototype),"_onImageLoad",e).call(e,t),e.drawImage(e.img[0],n)})).catch((function(t){e.dispatchEvent("Error",t)})):(p(h(i.prototype),"_onImageLoad",this).call(this,t),this.drawImage(this.img[0],n))}},{key:"showImage",value:function(t,e){var i=document.createElement("canvas");i.width=this.canvasContainer.clientWidth,i.height=this.canvasContainer.clientHeight,i.style.opacity=0,i.style.imageRendering="pixelated";var n=this.createMediaElement();this.setProps(i.style,this.preferences[n instanceof HTMLVideoElement?"videoLayerStyle":"imgLayerStyle"]),i.image=n,i.frame=0,this.addImageLayer(i)}},{key:"createCanvasContainer",value:function(){p(h(i.prototype),"createCanvasContainer",this).call(this,"div")}}]),i}(F);customElements.define("chameleon-canvas",O);var _=function(t){l(i,t);var e=g(i);function i(t){var n;return s(this,i),u(m(n=e.call(this,t)),"transitions",["DotGain","Pipe","Grinder","Fader","Star"]),u(m(n),"additionalSettings",{imgLayerStyle:{opacity:0,position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent"},fps:60,zoomspeed:5,transitionEase:.2,transitionDuration:2,direction:"random",rotation:.1,grid:"auto",transition:"random"}),n.setPreferences(n.additionalSettings),n}return a(i,[{key:"transitionPipe",value:function(t){var e=t.getContext("2d");e.beginPath();var i=this.transitionFrame*Math.max(t.width,t.height)/this.get("transitionDuration")/this.get("fps")+this.get("transitionEase",1)*this.transitionFrame*this.transitionFrame;e.arc(t.width/2,t.height/2,i,0,2*Math.PI),e.fill(),e.closePath(),i>Math.max(t.width,t.height)&&this.dispatchEvent("TransitionEnd")}},{key:"transitionStar",value:function(t){var e=new S(t),i=Math.max(t.width,t.height)*this.get("transitionDuration")/this.get("fps")*this.transitionFrame/2;e.draw({outerRadius:i,innerRadius:i/2,rotation:this.get("currentDirection")}),i>Math.max(t.width,t.height)&&this.dispatchEvent("TransitionEnd")}},{key:"transitionGrinder",value:function(t){var e=t.getContext("2d"),i=2*Math.max(t.height,t.width),n="auto"===this.get("grid")?n=Math.floor(i/30)+1:this.get("grid").x||this.get("grid"),r=n?i/n:0;e.translate(t.width/2,t.height/2),e.rotate(this.get("currentDirection")*Math.PI/180),e.beginPath();for(var s=this.transitionFrame*i/this.get("transitionDuration")/this.get("fps"),o=0;o<=r;o+=1)e.rect(o*n-i/2,-i/2,n/2,s),e.rect((o+.5)*n-i/2,i/2,n/2,-s);e.fill(),e.closePath(),e.setTransform(1,0,0,1,0,0),s===i&&this.dispatchEvent("TransitionEnd")}},{key:"transitionDotGain",value:function(t){var e,i=t.getContext("2d"),n=Math.max(t.height,t.width);if(i.beginPath(),1===this.transitionFrame||!this.preferences.origin){var r=Math.floor(4*Math.random());this.preferences.origin={x:0==r||2==r?t.width*Math.random():3==r?t.width:0,y:1==r||3==r?t.height*Math.random():2==r?t.height:0}}e="auto"===this.get("grid")?{x:n/25,y:n/25}:{x:this.get("grid").x||this.get("grid",n/30),y:this.get("grid").y||this.get("grid",n/30)};for(var s,o,a,u,l=0,h=0;h<=t.width/e.x+1;h+=1)for(var c=0;c<=t.height/e.y+1;c+=1){i.moveTo(0,0);var d=(s=h*e.x,o=c*e.y,a=this.preferences.origin.x,u=this.preferences.origin.y,-~~Math.sqrt(Math.pow(a-s,2)+Math.pow(u-o,2))*this.get("transitionDuration")/this.get("fps")/2+this.get("transitionEase",0)*this.transitionFrame+this.transitionFrame/this.get("fps")*Math.abs(e.x,e.y));d<Math.max(e.x,e.y)?l++:d=Math.max(e.x,e.y),d>0&&i.arc(~~h*e.x,~~c*e.y,d,0,2*Math.PI)}i.fillStyle="white",i.fill(),i.closePath(),l||this.dispatchEvent("TransitionEnd")}},{key:"_onTransitionStart",value:function(){this.currentTransition="random"===this.get("transition")?this.transitions[Math.floor(Math.random()*this.transitions.length)]:this.get("transition"),p(h(i.prototype),"_onTransitionStart",this).call(this)}},{key:"updateClipPathTransition",value:function(){if("Fader"===this.currentTransition)return 1===this.transitionFrame&&(this.imageLayersMax=4,this.replaceCanvasWithDiv(),this.imageContainer.removeChild(this.img[1]),this.img.splice(1,1),this.img[0].style.backgroundColor="rgba(0,0,0,1)",this.img[0].style.opacity=0),p(h(i.prototype),"updateClipPathTransition",this).call(this);for(var t=0;t<this.img.length;t++){var e=this.img[t],n=1+e.frame*this.get("zoomspeed",0)/1e3/this.get("fps");if(0===t&&this.suspended||e.frame++,e.style.zIndex=this.img.length-t,e instanceof HTMLCanvasElement){var r,s,o=e.getContext("2d");if(o.globalCompositeOperation="source-over",0===t)o.clearRect(0,0,e.width,e.height),o.fillStyle="#000",o.fillRect(0,0,e.width,e.height),this.drawImage(e,null!==(r=null!==(s=e.video)&&void 0!==s?s:e.bitmap)&&void 0!==r?r:e.image,n),this.transitionFrame&&(o.globalCompositeOperation="destination-in",1===this.transitionFrame&&(this.preferences.currentDirection="random"===this.get("direction")?360*Math.random():this.get("direction",90)),o.moveTo(0,0),this.preferences.currentDirection+=this.get("rotation"),this["transition"+this.currentTransition](e),e.style.opacity=1)}else e.style.transform="scale("+n+","+n+")"}}}]),i}(O);customElements.define("chameleon-transitions",_);var j=function(t){l(i,t);var e=g(i);function i(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return s(this,i),u(m(r=e.call(this)),"lastMessage",void 0),u(m(r),"keepEventsNum",50),u(m(r),"repetitions",0),u(m(r),"skipRedundantMessages",!0),u(m(r),"debugContainer",void 0),u(m(r),"debugHeader",void 0),u(m(r),"debugContent",void 0),u(m(r),"context",void 0),r.context=t,r.watchProperties=a,r.watchListeners=o,r.ignoreEvents=l,r.buildContainer(),r.addWatchers(),console.log=function(t){if("object"==n(t))this.debug("log",JSON.stringify(t));else{for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.debug("log",t,JSON.stringify(i))}},r}return a(i,[{key:"addWatchers",value:function(){for(var t=this,e=0;e<this.watchListeners.length;e++){var i=this.watchListeners[e];this.context[i]=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.onWatch.apply(t,[e].concat(n))}}}},{key:"onWatch",value:function(t){var e=this.watchProperties;this.debugHeader.innerHTML="";for(var i=0;i<e.length;i++){var n=document.createElement("div"),r=document.createElement("div");r.classList.add("label",e[i]),r.innerHTML=e[i],n.appendChild(r),(r=document.createElement("div")).classList.add("value",e[i]),r.innerHTML=this.context[e[i]],n.appendChild(r),this.debugHeader.appendChild(n)}for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];-1===this.ignoreEvents.indexOf(t)&&this.debug.apply(this,[t].concat(o))}},{key:"cutOff",value:function(){for(;this.debugContent.children.length>this.keepEventsNum;)this.debugContent.removeChild(this.debugContent.firstChild)}},{key:"buildContainer",value:function(){this.debugContainer=document.createElement("div"),this.debugContainer.classList.add("debugContainer"),this.appendChild(this.debugContainer),this.debugHeader=document.createElement("div"),this.debugHeader.classList.add("header"),this.debugContainer.appendChild(this.debugHeader),this.debugContent=document.createElement("div"),this.debugContent.classList.add("content"),this.debugContainer.appendChild(this.debugContent)}},{key:"debug",value:function(t){var e=this.debugContent,i=e.scrollHeight-e.scrollTop-e.clientHeight<1;if(this.skipRedundantMessages){if(t===this.lastMessage)return void this.repetitions++;if(this.repetitions>1){var n=document.createElement("span");n.classList.add("repetitions"),n.innerHTML=".."+this.repetitions+"x ",e.appendChild(n)}}this.repetitions=0;var r=document.createElement("div");r.classList.add("event",t);var s=document.createElement("span");s.innerHTML=t,r.appendChild(s);for(var o=arguments.length,a=new Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];a&&((s=document.createElement("span")).classList.add(t,"payload"),s.innerHTML=" "+JSON.stringify(a),r.appendChild(s)),(s=document.createElement("span")).innerHTML=" ",r.appendChild(s),e.appendChild(r),i&&e.scrollTo(0,e.scrollHeight),this.lastMessage=t,this.cutOff()}}]),i}(f(HTMLElement));customElements.define("screen-debugger",j);var H=function(t){l(i,t);var e=g(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s(this,i),u(m(t=e.call(this)),"menu",void 0),u(m(t),"buttons",void 0),u(m(t),"target",void 0),u(m(t),"title",void 0),u(m(t),"expanded",!1),u(m(t),"items",[]),u(m(t),"queryParam","page"),u(m(t),"hideClass","hide"),u(m(t),"activeClass","active"),u(m(t),"defaultMenuItemNum",void 0),u(m(t),"selectedMenuItemNum",void 0),r&&t.init(n),t}return a(i,[{key:"init",value:function(t){var e,i,n,r,s,o,a,u,l=this;(this.menu=t,this.queryParam=(null===(e=this.attributes.queryParam)||void 0===e?void 0:e.value)||this.queryParam||"page",this.hideClass=(null===(i=this.attributes.hideClass)||void 0===i?void 0:i.value)||this.hideClass||"hide",this.activeClass=(null===(n=this.attributes.activeClass)||void 0===n?void 0:n.value)||this.activeClass||"active",this.buttons=this.querySelectorAll((null===(r=this.attributes.button)||void 0===r?void 0:r.value)||"button.sandwich"),this.buttons.forEach((function(t){t.addEventListener("click",(function(t){return l._onClick(t)}))})),this.attributes.target)&&(this.target=this.querySelector((null===(o=this.attributes.target)||void 0===o?void 0:o.value)||".content"));this.target||(this.target=document.createElement("div"),null!==(a=this.attributes.targetClass)&&void 0!==a&&a.value&&this.target.classList.add(this.attributes.targetClass.value.split(" ")),this.appendChild(this.target));(this.menu=this.querySelector((null===(s=this.attributes.menu)||void 0===s?void 0:s.value)||"ul.menu"),this.menu)?this.menu.querySelectorAll("li").forEach((function(t){t.dataset.link=l.buildPageUrl(t.innerHTML.toLowerCase());var e=l.items.push(t);t.addEventListener("click",(function(t){return l._onClickMenuItem(e-1)}))})):(this.menu=document.createElement("ul"),null!==(u=this.attributes.menuClass)&&void 0!==u&&u.value&&this.menu.classList.add(this.attributes.menuClass.value.split(" ")),this.appendChild(this.menu));this.createMenuItems();var h=this.getMenuItemNumByUrl(this.getPage());this._onToggle(void 0!==h),this.selectMenuItemNum(null!=h?h:this.defaultMenuItemNum),this.updateQuery()}},{key:"buildPageUrl",value:function(t){return"/pages/"+t+".html"}},{key:"getMenuItemNumByUrl",value:function(t){for(var e in this.items)if(this.items[e].dataset.link===t)return e}},{key:"createMenuItems",value:function(){var t=this;if(this.attributes.items.value){var e=JSON.parse(this.attributes.items.value);if(Array.isArray(e)){var i=function(){var i=document.createElement("li");if(e[n]instanceof String||"string"==typeof e[n])i.innerHTML=e[n];else{i.innerHTML=e[n].title;for(var r=0,s=Object.keys(e[n]);r<s.length;r++){var o=s[r];i.dataset[o]=e[n][o]}}i.dataset.link||(i.dataset.link=t.buildPageUrl(i.innerHTML.toLowerCase())),t.menu.appendChild(i);var a=t.items.push(i)-1;i.addEventListener("click",(function(e){return t._onClickMenuItem(a)})),!0===e[n].default&&(t.defaultMenuItemNum=a)};for(var n in e)i()}}}},{key:"_onLoadPage",value:function(t,e,i){"function"==typeof this.onLoadPage&&this.onLoadPage(t,e,i),t.style.display="none",t.style.display="block"}},{key:"setPage",value:function(t){this.page=t,this.updateQuery(t)}},{key:"updateQuery",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e=null!==(t=e)&&void 0!==t?t:this.getPage();var i=new URL(window.location);this.expanded&&void 0!==e?i.searchParams.set(this.queryParam,e):i.searchParams.delete(this.queryParam),history.pushState({},"",i)}},{key:"getPage",value:function(){var t=new URLSearchParams(window.location.search),e=Object.fromEntries(t.entries());return e[this.queryParam]&&(this.page=e[this.queryParam]),this.page}},{key:"selectMenuItemNum",value:function(t){var e,i,n=this;t=void 0!==t?t:this.selectMenuItemNum;var r=this.items[t],s=null===(e=r.dataset)||void 0===e?void 0:e.link;this.setPage(s),this.target&&fetch(s).then((function(t){return t.text()})).then((function(t){var e=(new DOMParser).parseFromString(t,"text/html");if(n.target.innerHTML="",e.body){var i=n.target.appendChild(e.body);n._onLoadPage(i,s,r)}else n.target.innerHTML="Ressource "+s+" could not be loaded"})).catch((function(t){console.error("error loading ressource",r,t)})),null===(i=this.items[this.selectedMenuItemNum])||void 0===i||i.classList.remove(this.activeClass),this.selectedMenuItemNum=t,this.items[this.selectedMenuItemNum].classList.add(this.activeClass)}},{key:"_onClickMenuItem",value:function(t){this.selectMenuItemNum(t)}},{key:"_onToggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.expanded=void 0!==t?t:!this.expanded;var e=[this.menu,this.target];this.attributes.permanent&&(e=this.children);for(var i=0;i<e.length;i++)e[i].classList.contains(this.attributes.permanent.value)||(this.expanded?e[i].classList.remove(this.hideClass):e[i].classList.add(this.hideClass));this.style.pointerEvents=this.expanded?"all":"none",this.updateQuery(this.getPage()),this.onToggle&&this.onToggle(this.expanded)}},{key:"_onClick",value:function(t){this._onToggle()}}]),i}(f(HTMLElement));customElements.define("menu-sandwich",H);var q,R,D=function(t){l(i,t);var e=g(i);function i(){var t;return s(this,i),u(m(t=e.call(this)),"searchterm",void 0),u(m(t),"input",void 0),t.input=t.querySelector("input"),t.input||(t.input=document.createElement("input"),t.appendChild(t.input)),t.input.addEventListener("focus",(function(e){return t._onFocus(e)})),t.input.addEventListener("blur",(function(e){return t._onBlur(e)})),t.input.addEventListener("keyup",(function(e){return t._onKeyUp(e)})),t.input.addEventListener("change",(function(e){return t._onChange(e)})),t}return a(i,[{key:"_onChange",value:function(t){"function"==typeof this.onChange&&this.onChange(t)}},{key:"_onSubmit",value:function(t){"function"==typeof this.onSubmit&&this.onSubmit(t,this.input.value)}},{key:"_onKeyUp",value:function(t){"Enter"===t.key&&this._onSubmit(t),"function"==typeof this.onKeyUp&&this.onKeyUp(t)}},{key:"_onFocus",value:function(t){this.classList.add("focus"),"function"==typeof this.onFocus&&this.onFocus(t)}},{key:"_onBlur",value:function(t){this.classList.remove("focus"),"function"==typeof this.onBlur&&this.onBlur(t)}}]),i}(f(HTMLElement));customElements.define("div-search",D);var B=!0,z=!1;function U(){var t;document.querySelectorAll(".ssrContent").forEach((function(t){t.innerHTML=""}));var e=new URLSearchParams(window.location.search),i=Object.fromEntries(e.entries()),n=null===(t=decodeURI(window.location.pathname))||void 0===t?void 0:t.split("/");if("album"===n[1]&&(i.album=n[2],i.image=n[3]),(q=document.getElementById("gallery"))||(q=new _),"screen"===(null==i?void 0:i.debug)){var r=new j(q,["onEvent"],["suspended","transitionFrame","breakTimeFrame","currentImageNum","currentAlbumNum","userIdleTime"],["Paused","Idle","MouseMove"]);document.body.appendChild(r)}function s(t){var e=q.getFilteredResults({searchterm:t});R.querySelectorAll(".searchResults").forEach((function(t){t.innerHTML="<span class='highlight'>"+e.photos.length+"</span> photos in <span class='highlight'>"+e.albums.length+"</span> albums"}))}function o(t){q.applyFilters({searchterm:t}),q.setCurrentAlbumNum(0),q.setCurrentImageNum(0),q.init()}(q.setAttribute("id","gallery"),document.body.appendChild(q),window.gallery=q,q.loadData("/data/albums.json").then((function(t){console.log("params",i),q.setAlbums(t),q.importPreferences(i),q.init(i),q.run(),window.setFormValues(),s()})),"shuffle"===(null==i?void 0:i.order)&&q.setShuffleMode(!0),B)&&(document.querySelectorAll(".requestFullscreen").forEach((function(t){q.requestFullscreen(t,document.getElementById("fullscreenRoot"))})),(R=document.querySelector("div-search")).querySelector(".icon").addEventListener("click",(function(t){R.input.value="",o("")})),R.onKeyUp=function(t){s(t.target.value)},R.onSubmit=function(t){o(t.target.value)},document.querySelectorAll("menu-sandwich").forEach((function(t){t.onToggle=function(t){t?q.dispatchEvent("PureStart"):q.dispatchEvent("PureEnd")},t.init()})),q.loadData("/data/meta.json").then((function(t){var e;t&&(console.log("meta data loaded",t),q.setMetaData(t),null===(e=document.querySelectorAll(".meta-title"))||void 0===e||e.forEach((function(e){return e.innerHTML=null==t?void 0:t.title})))})),B=!1);document.querySelectorAll("button.topic").forEach((function(t){t.dataset.topic===q.preferences.transition?t.classList.add("active"):t.classList.remove("active")})),q.direction="random",q.onPureStart=function(){q.onIdle(180)},q.onPureEnd=function(){q.onIdleEnd()},q.onIdle=function(t){180==t&&document.querySelectorAll(".idleHide").forEach((function(t){t.classList.add("hide")}))},q.onPauseStart=function(){V("paused")},q.onPauseEnd=function(){V("running")},q.onIdleEnd=function(t){q.pureMode||document.querySelectorAll(".idleHide").forEach((function(t){t.classList.remove("hide")}))},q.onNavigation=function(t){document.querySelector("div.curtain")&&(document.querySelector("div.curtain").classList.add("hide"),setTimeout((function(){document.querySelector("div.curtain").classList.add("disabled"),document.body.removeChild(document.querySelector("div.curtain"))}),2e3),document.body.classList.remove("darkness")),q.currentDirection={"-1":90,"+1":270}[t.target]||q.currentDirection},q.onResize=function(){var t="scale(1)";document.body.style.webkitTransform=t,document.body.style.msTransform=t,document.body.style.transform=t,q.isFullscreen()||window.scrollTo(0,0)},q.onRequireInteraction=function(t){V("requiresInteraction"),console.log("Gallery requires interaction"),z=!0}}function V(t){document.querySelectorAll(".controls .button.toggle").forEach((function(e){e.previousState&&(e.classList.remove(e.previousState),e.previousState=void 0),e.classList.add("stress",t),e.previousState=t,setTimeout((function(){e.classList.remove("stress")}),1e3)}))}function W(){V("running"),q.dispatchEvent("VideoPlay"),z=!1}document.querySelector("menu-sandwich").onLoadPage=function(t,e,i){window.setFormValues(t.querySelector("form"))},window.setFormValues=function(t){t=t||document.querySelector("form");var e=q.getPreferences(!0);if(t)for(var i=function(){var i=y(r[n],2),s=i[0],o=i[1],a=t.querySelectorAll('[name="'+s+'"]');Array.isArray(o)&&0===a.length&&(a=t.querySelectorAll('[name="'+s+'[]"]')),a.forEach((function(t){if(t.options)for(var i=0;i<t.options.length;i++){var n=t.options[i];n.value===o||Array.isArray(o)&&-1!==o.indexOf(n.value)?t.options[i].setAttribute("selected",""):t.options[i].removeAttribute("selected")}else"checkbox"===t.type?t.checked=1==e[t.name]:"hidden"!==t.type&&(t.value=o)}))},n=0,r=Object.entries(e);n<r.length;n++)i()},window.onSubmitSettings=function(t,e){t.preventDefault();var i,n={},r=C(new FormData(e).entries());try{for(r.s();!(i=r.n()).done;){var s=y(i.value,2),o=s[0],a=s[1];"[]"===o.substring(o.length-2)?(Array.isArray(n[o])||(n[o]=[]),n[o].push(a)):n[o]=a}}catch(t){r.e(t)}finally{r.f()}for(var u={},l=new URL(window.location),h=0,c=Object.entries(n);h<c.length;h++){var d=y(c[h],2),v=d[0],f=d[1];l.searchParams.set("p."+v,f),u[v="[]"===v.substring(v.length-2)?v.substring(0,v.length-2):v]=f,q.set(v,f)}history.pushState({},"",l),u["filters.safety"]&&(q.applyFilters(),q.setCurrentAlbumNum(0),q.setCurrentImageNum(0),q.init()),window.setFormValues()},document.addEventListener("DOMContentLoaded",(function(){U(),document.querySelectorAll("button.topic").forEach((function(t){return t.addEventListener("click",(function(){return U(t.dataset.topic)}))})),document.querySelectorAll(".controls .button.toggle").forEach((function(t){return t.addEventListener("click",(function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;z?W():q.setPaused(t)}()}))})),document.addEventListener("mousedown",(function(){W()})),document.addEventListener("keydown",(function(){W()})),document.querySelectorAll(".controls .button.navi").forEach((function(t){return t.addEventListener("click",(function(){return e=t.dataset.target,void q.navigate(e);var e}))}))}))}();
